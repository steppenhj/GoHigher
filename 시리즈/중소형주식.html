<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>중소형 주식 투자 가이드 | 미국 성장주·섹터별 소형주 정보 - GoHigher</title>
<meta name="description" content="성장 잠재력이 높은 미국 중소형주를 기술, 헬스케어, 금융, 소비재, 산업재 등 카테고리별로 한눈에! 시가총액, 실시간 시세, 투자 포인트와 상세분석까지 GoHigher에서 쉽고 빠르게 확인하세요.">
<meta name="keywords" content="중소형주, 미국 주식, 성장주, 소형주, 기술주, 헬스케어주, 금융주, 소비재, 산업재, 섹터별 주식, 주식검색, 투자정보, 시가총액, 실시간 주가, 종목분석, GoHigher">

<!-- 사이트 검증 메타 -->
<meta name="naver-site-verification" content="daa71973aba155bc2d96dfde44d8fb34b6a74ba7" />
<meta name="google-site-verification" content="GGuWsc5cbeYC9W0nQsN7550kWcUzArKuo3zfhjN5LXE"/>

<!-- Open Graph (카톡/페북/SNS 공유용) -->
<meta property="og:type" content="article" />
<meta property="og:title" content="중소형 주식 투자 가이드 | 미국 성장주·섹터별 소형주 한눈에" />
<meta property="og:description" content="기술·헬스케어·금융·소비재·산업재 등 미국 중소형주를 한 곳에서! 실시간 주가, 투자 팁, 상세 종목 정보까지 GoHigher에서 확인하세요." />
<meta property="og:image" content="https://gohigher.kr/logo.jpg" />
<meta property="og:url" content="https://gohigher.kr/시리즈/중소형주식.html" />
<meta property="og:site_name" content="Go Higher" />
<meta property="og:locale" content="ko_KR" />

<!-- Twitter Card (트위터/X 공유용) -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="중소형 주식 투자 가이드 | 미국 성장주·소형주·섹터별 한눈에" />
<meta name="twitter:description" content="미국 중소형주 실시간 시세·섹터별 필터·투자 포인트를 GoHigher에서 쉽고 빠르게 확인하세요!" />
<meta name="twitter:image" content="https://gohigher.kr/logo.jpg" />

<!-- 파비콘 -->
<link rel="icon" href="/logo.jpg" type="image/jpeg" />
    
  <link rel="stylesheet" href="../navigation.css">

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>  
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700;400&display=swap" rel="stylesheet">
  <style>
    /* 중소형 주식 페이지 스타일 */
:root {
  --nav-main: rgba(28, 36, 52, 0.75);
  --nav-blue: #e9f1ff;
  --nav-blue-light: #98bfff;
  --nav-yellow: #ffe066;
  --bg-main: linear-gradient(120deg, #1e253a 0%, #253258 100%);
  --card-bg: rgba(32, 38, 60, 0.85);
  --card-border: rgba(76, 90, 110, 0.52);
  --card-shadow: 0 4px 32px 0 rgba(12, 18, 40, 0.26);
  --text-primary: #dae7ff;
  --text-secondary: #b7caf8;
  --text-muted: #8ba3d4;
  --success-color: #4ade80;
  --danger-color: #f87171;
  --warning-color: #fbbf24;
}

.main-content {
  min-height: calc(100vh - 66px);
  padding: 40px 20px;
  background: linear-gradient(135deg, #1C2434 0%, #0C1228 60%, #2D3E5B 100%);
}

.container {
  max-width: 1200px;
  margin: 0 auto;
}

/* 페이지 헤더 */
.page-header {
  text-align: center;
  margin-bottom: 50px;
  padding: 40px 0;
}

.page-title {
  font-size: 2.5rem;
  font-weight: 700;
  color: var(--nav-blue-light);
  margin: 0 0 16px 0;
  text-shadow: 0 2px 10px rgba(152, 191, 255, 0.3);
  letter-spacing: 0.02em;
}

.page-subtitle {
  font-size: 1.1rem;
  color: var(--text-secondary);
  margin: 0;
  line-height: 1.6;
}

/* 검색 섹션 */
.search-section {
  margin-bottom: 40px;
}

.search-container {
  background: var(--card-bg);
  backdrop-filter: blur(18px);
  border: 1.7px solid var(--card-border);
  border-radius: 20px;
  padding: 30px;
  box-shadow: var(--card-shadow);
}

.search-box {
  position: relative;
  margin-bottom: 25px;
}

.search-icon {
  position: absolute;
  left: 16px;
  top: 50%;
  transform: translateY(-50%);
  width: 20px;
  height: 20px;
  color: var(--text-muted);
  z-index: 2;
}

.search-input {
  width: 100%;
  padding: 16px 50px 16px 50px;
  background: rgba(255, 255, 255, 0.08);
  border: 1.5px solid rgba(76, 90, 110, 0.4);
  border-radius: 15px;
  color: var(--text-primary);
  font-size: 1rem;
  font-family: inherit;
  transition: all 0.3s ease;
  box-sizing: border-box;
}

.search-input::placeholder {
  color: var(--text-muted);
}

.search-input:focus {
  outline: none;
  border-color: var(--nav-blue-light);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 0 3px rgba(152, 191, 255, 0.1);
}

.clear-search {
  position: absolute;
  right: 16px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 1.2rem;
  cursor: pointer;
  padding: 4px;
  border-radius: 50%;
  transition: all 0.2s ease;
}

.clear-search:hover {
  background: rgba(255, 255, 255, 0.1);
  color: var(--text-primary);
}

/* 필터 버튼 */
.filter-buttons {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
  justify-content: center;
}

.filter-btn {
  padding: 10px 20px;
  background: rgba(255, 255, 255, 0.08);
  border: 1.5px solid rgba(76, 90, 110, 0.4);
  border-radius: 12px;
  color: var(--text-secondary);
  font-size: 0.95rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s ease;
  font-family: inherit;
}

.filter-btn:hover {
  background: rgba(255, 255, 255, 0.15);
  border-color: var(--nav-blue-light);
  color: var(--nav-blue-light);
}

.filter-btn.active {
  background: linear-gradient(90deg, #2c3855 50%, #3a4d77 110%);
  border-color: var(--nav-yellow);
  color: var(--nav-yellow);
  font-weight: 600;
  box-shadow: 0 2px 14px 0 rgba(255, 224, 102, 0.2);
}

/* 로딩 인디케이터 */
.loading-indicator {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 20px;
  color: var(--text-secondary);
}

.loading-spinner {
  width: 40px;
  height: 40px;
  border: 3px solid rgba(152, 191, 255, 0.2);
  border-top: 3px solid var(--nav-blue-light);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 20px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* 주식 그리드 */
.stocks-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: 25px;
  margin-top: 30px;
}

/* 주식 카드 */
.stock-card {
  background: var(--card-bg);
  backdrop-filter: blur(18px);
  border: 1.7px solid var(--card-border);
  border-radius: 18px;
  padding: 25px;
  cursor: pointer;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.stock-card::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: linear-gradient(112deg, rgba(43, 56, 81, 0.25) 50%, rgba(17, 25, 43, 0.34) 100%);
  opacity: 0.85;
  z-index: 0;
}

.stock-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 40px 0 rgba(30, 38, 85, 0.19), 0 3px 12px 0 rgba(27, 32, 58, 0.21);
  border-color: var(--nav-blue-light);
}

.stock-card > * {
  position: relative;
  z-index: 1;
}

.stock-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 20px;
}

.stock-info h3 {
  font-size: 1.3rem;
  font-weight: 700;
  color: var(--nav-blue-light);
  margin: 0 0 5px 0;
  line-height: 1.3;
}

.stock-symbol {
  font-size: 0.9rem;
  color: var(--text-muted);
  font-weight: 500;
}

.stock-category {
  padding: 4px 12px;
  background: rgba(255, 224, 102, 0.15);
  border: 1px solid rgba(255, 224, 102, 0.3);
  border-radius: 8px;
  font-size: 0.8rem;
  color: var(--nav-yellow);
  font-weight: 500;
}

.stock-price {
  text-align: right;
}

.current-price {
  font-size: 1.4rem;
  font-weight: 700;
  color: var(--text-primary);
  margin-bottom: 5px;
}

.price-change {
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 0.9rem;
  font-weight: 500;
}

.price-change.positive {
  color: var(--success-color);
}

.price-change.negative {
  color: var(--danger-color);
}

.price-change.neutral {
  color: var(--text-muted);
}

.stock-details {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
  margin-top: 20px;
}

.detail-item {
  display: flex;
  flex-direction: column;
  gap: 5px;
}

.detail-label {
  font-size: 0.85rem;
  color: var(--text-muted);
  font-weight: 500;
}

.detail-value {
  font-size: 1rem;
  color: var(--text-primary);
  font-weight: 600;
}

/* 모달 */
.modal {
  display: none;
  position: fixed;
  z-index: 1000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.7);
  backdrop-filter: blur(5px);
}

.modal.active {
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-content {
  background: var(--card-bg);
  backdrop-filter: blur(20px);
  border: 1.7px solid var(--card-border);
  border-radius: 20px;
  width: 90%;
  max-width: 600px;
  max-height: 80vh;
  overflow-y: auto;
  box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 25px 30px 20px;
  border-bottom: 1px solid rgba(76, 90, 110, 0.3);
}

.modal-header h2 {
  color: var(--nav-blue-light);
  margin: 0;
  font-size: 1.5rem;
  font-weight: 700;
}

.modal-close {
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 1.5rem;
  cursor: pointer;
  padding: 5px;
  border-radius: 50%;
  transition: all 0.2s ease;
}

.modal-close:hover {
  background: rgba(255, 255, 255, 0.1);
  color: var(--text-primary);
}

.modal-body {
  padding: 30px;
}

/* 상세 정보 스타일 */
.stock-detail-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  margin-bottom: 30px;
}

.detail-card {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(76, 90, 110, 0.3);
  border-radius: 12px;
  padding: 20px;
}

.detail-card h4 {
  color: var(--nav-yellow);
  margin: 0 0 10px 0;
  font-size: 1rem;
  font-weight: 600;
}

.detail-card p {
  color: var(--text-primary);
  margin: 0;
  font-size: 1.1rem;
  font-weight: 700;
}

/* 반응형 디자인 */
@media (max-width: 768px) {
  .page-title {
    font-size: 2rem;
  }
  
  .search-container {
    padding: 20px;
  }
  
  .filter-buttons {
    gap: 8px;
  }
  
  .filter-btn {
    padding: 8px 16px;
    font-size: 0.9rem;
  }
  
  .stocks-grid {
    grid-template-columns: 1fr;
    gap: 20px;
  }
  
  .stock-card {
    padding: 20px;
  }
  
  .modal-content {
    width: 95%;
    margin: 20px;
  }
  
  .modal-header,
  .modal-body {
    padding: 20px;
  }
}

@media (max-width: 480px) {
  .main-content {
    padding: 20px 15px;
  }
  
  .page-header {
    margin-bottom: 30px;
    padding: 30px 0;
  }
  
  .page-title {
    font-size: 1.8rem;
  }
  
  .page-subtitle {
    font-size: 1rem;
  }
  
  .stock-details {
    grid-template-columns: 1fr;
    gap: 12px;
  }
} 
  </style>
</head>
<body>
<nav class="nav">
  <div class="nav-left">
    <button class="hamburger-btn" id="openSidebarBtn" aria-label="메뉴 열기">
      <svg viewBox="0 0 22 22">
        <rect y="4" width="22" height="1.3" rx="0.6" fill="#e9f1ff"/>
        <rect y="10" width="22" height="1.3" rx="0.6" fill="#e9f1ff"/>
        <rect y="16" width="22" height="1.3" rx="0.6" fill="#e9f1ff"/>
      </svg>
    </button>
    <span class="brand">Go Higher</span>
    <div class="nav-menu">
      <a href="/" class="nav-link">홈</a>
      <a href="/뉴스.html" class="nav-link">뉴스</a>
      <a href="/다이어리.html" class="nav-link">다이어리</a>
      <a href="/시리즈.html" class="nav-link active">시리즈</a>
      <a href="/멤버십.html" class="nav-link">멤버십</a>
    </div>
  </div>
  <div class="nav-right" id="navRight">
    <div class="stock-search">
  <input
    id="stockSearchInput"
    type="text"
    placeholder="티커/심볼 (예: AAPL, MSFT)"
    autocomplete="off"
    style="width:180px;max-width:220px;"
  />
  <button
    class="btn stock-btn"
    id="stockSearchBtn"
    aria-label="주식 검색"
    title="주식 검색"
    style="margin-left:-2px;"
  >
    <svg xmlns="http://www.w3.org/2000/svg" class="icon-search" viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
      <path fill-rule="evenodd" d="M11 4a7 7 0 014.899 11.899l4.6 4.6a1 1 0 01-1.414 1.414l-4.6-4.6A7 7 0 1111 4zm0 2a5 5 0 100 10 5 5 0 000-10z" clip-rule="evenodd"/>
    </svg>
  </button>
</div>

<button class="btn" id="shareBtn">
  <span style="font-size:1.12em; margin-right:5px; vertical-align:-2px;">🔗</span>
  공유
</button>
    <a href="/login.html" class="btn login" id="loginBtn">로그인</a>
    <img id="profilePhoto" class="profile-photo" src="/default-profile.png" alt="프로필" style="display:none;" />
  </div>
</nav>

  <div class="overlay" id="sidebarOverlay"></div>
  <aside class="sidebar" id="sidebar">
    <button class="sidebar-close" id="closeSidebarBtn" aria-label="닫기">&times;</button>
    <h2>Go Higher 메뉴</h2>
    <div class="user-info">
      <span class="user-icon" style="background:#f0e85a;border-radius:50%;width:36px;height:36px;display:inline-block;vertical-align:middle;overflow:hidden;">
        <img src="" alt="프로필" class="user-photo" style="width:100%;height:100%;object-fit:cover;display:none;">
      </span>
      <div>
        <div class="user-name">비로그인</div>
        <div class="user-email" style="font-size:0.98em; color:#b7caf8; margin-top:2px;"></div>
        <div class="user-status">로그인 필요</div>
      </div>
    </div>
    <hr>
    <div>
      <a href="/마이페이지.html" class="side-link">마이페이지</a>
      <a href="/설정.html" class="side-link">설정</a>
    </div>
    <hr>
        <div>
      <a href="/" class="side-link">홈</a>
      <a href="/뉴스.html" class="side-link">뉴스</a>
      <a href="/다이어리.html" class="side-link">다이어리</a>
      <a href="/시리즈.html" class="side-link">시리즈</a>
      <a href="/멤버십.html" class="side-link">멤버십</a>
    </div>

    <a href="/login.html" class="side-link">로그아웃</a>
    <hr>
    <div class="biz-info-title">사업자 등록</div>
    <div class="biz-info">GoHigher | 대표 박해진</div>
    <div class="biz-info">대구광역시 북구 동천로 155, 네스빌101동 12층</div>
    <div class="biz-info">사업자번호 407-09-54622</div>
    <div class="biz-info">연락처 070-8080-1675</div>
    <hr>

  <!-- 정책/소개/약관 버튼 -->
  <div class="policy-links" style="margin-top:16px; padding:10px 0 2px 0; display:flex; flex-wrap:wrap; gap:12px; font-size:0.87em; color:#a2b6d8;">
    <a href="푸터/이용약관.html" class="policy-link" style="color:inherit; text-decoration:none;">이용약관</a>
    <a href="푸터/privacy-policy.html" class="policy-link" style="color:inherit; text-decoration:none;">개인정보처리방침</a>
    <a href="푸터/환불정책.html" class="policy-link" style="color:inherit; text-decoration:none;">환불정책</a>
  </div>
  <!-- 저작권 문구 -->
   <div class="copyright" style="margin-top:14px; font-size:11.8px; color:#8e9bb3; text-align:center; letter-spacing:0.01em;">
    © 2025 GoHigher. All rights reserved

</aside>

<!-- 검색 모달 -->
<div id="searchModal" class="search-modal" style="display:none; min-width:370px; max-width:99vw;">
  <button id="closeSearchModal" class="modal-close" aria-label="닫기">&times;</button>
  <h2 class="modal-title" style="margin-bottom:2px;">검색 결과</h2>
  <div id="stockModalTabs"
       style="display:flex; gap:8px; margin:10px 0 20px 0; flex-wrap:wrap;"></div>
  <div id="modalResult" class="stock-result"></div>
</div>
<div id="searchModalOverlay" class="modal-overlay" style="display:none;"></div>

  <script src="../navigation.js"></script>


  <!-- 메인 컨텐츠 -->
  <main class="main-content">
    <div class="container">
      <!-- 헤더 섹션 -->
      <header class="page-header">
        <h1 class="page-title">중소형 주식 투자 가이드</h1>
        <p class="page-subtitle">성장 잠재력이 높은 중소형 주식들을 사업 카테고리별로 정리했습니다</p>
      </header>

      <!-- 검색 섹션 -->
      <section class="search-section">
        <div class="search-container">
          <div class="search-box">
            <svg class="search-icon" viewBox="0 0 24 24" fill="none">
              <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <input type="text" id="searchInput" placeholder="주식명, 종목코드, 또는 업종으로 검색..." class="search-input">
            <button id="clearSearch" class="clear-search" style="display: none;">×</button>
          </div>
          <div class="filter-buttons">
            <button class="filter-btn active" data-category="all">전체</button>
            <button class="filter-btn" data-category="tech">기술</button>
            <button class="filter-btn" data-category="healthcare">헬스케어</button>
            <button class="filter-btn" data-category="finance">금융</button>
            <button class="filter-btn" data-category="consumer">소비재</button>
            <button class="filter-btn" data-category="industrial">산업재</button>
          </div>
        </div>
      </section>

      <!-- 로딩 인디케이터 -->
      <div id="loadingIndicator" class="loading-indicator">
        <div class="loading-spinner"></div>
        <p>주식 정보를 불러오는 중...</p>
      </div>

      <!-- 주식 카드 그리드 -->
      <section class="stocks-grid" id="stocksGrid">
        <!-- 주식 카드들이 여기에 동적으로 추가됩니다 -->
      </section>

      <!-- 주식 상세 모달 -->
      <div id="stockModal" class="modal">
        <div class="modal-content">
          <div class="modal-header">
            <h2 id="modalTitle">주식 상세 정보</h2>
            <button class="modal-close" id="closeModal">&times;</button>
          </div>
          <div class="modal-body" id="modalBody">
            <!-- 상세 정보가 여기에 표시됩니다 -->
          </div>
        </div>
      </div>
    </div>
  </main>
<footer class="main-footer">
  <div class="footer-wrap">
    <div class="footer-brand">
      <img src="/logo.jpg" alt="Go Higher 로고" class="footer-logo" />
      <div class="footer-title">
        <span>Go Higher</span>
        <span class="footer-sub">미국주식 데이터 허브</span>
      </div>
    </div>
    <div class="footer-links">
      <a href="/푸터/이용약관.html">이용약관</a>
      <a href="/푸터/privacy-policy.html">개인정보처리방침</a>
      <a href="/푸터/환불정책.html">환불정책</a>
      <a href="/멤버십.html">멤버십 안내</a>
      <a href="/contact.html">문의하기</a>
    </div>
    <div class="footer-info">
      <span><b>대표</b> 박해진</span>
      <span><b>사업자</b> 407-09-54622</span>
      <span><b>주소</b> 대구광역시 북구 동천로 155, 네스빌101동 12층</span>
      <span><b>문의</b> 070-8080-1675</span>
      <span><b>이메일</b> help@gohigher.kr</span>
    </div>
  </div>
  <div class="footer-bottom">
    <span>© 2025 Go Higher. All rights reserved.</span>
    <span>GoHigher의 모든 콘텐츠는 오직 정보 제공을 목적으로 하며, 특정 주식이나 금융상품의 판매 또는 추천을 위한 것이 아닙니다. 본 콘텐츠는 공식적인 연구 보고서가 아니며, 투자 결정의 유일한 근거로 삼아서는 안 됩니다.

투자에는 항상 위험이 따르며, 과거의 성과가 미래의 결과나 수익을 보장하지 않습니다. 금융상품 투자 시에는 재정적 손실 가능성을 충분히 인지하고, 본인의 투자 목표와 위험 수준을 신중하게 고려한 후 투자하시기 바랍니다.</span>
  </div>
</footer>
 <script>
class SmallCapStocks {
  constructor() {
    this.stocks = [];
    this.filteredStocks = [];
    this.searchTerm = '';
    this.currentCategory = 'all';
    this.apiKey = 'wFORda5lesMUZ96BmvpJ4x4cE3F2PqBt';
    this.nextCursor = null;
    this.loading = false;
    this.loadedSymbols = new Set(); // 이미 로드된 심볼들을 추적
    document.addEventListener('DOMContentLoaded', () => this.init());
  }

  async init() {
    this.setupListeners();
    await this.loadTickers();
    this.setupInfiniteScroll();
  }

  setupListeners() {
    const search = document.getElementById('searchInput');
    const clear = document.getElementById('clearSearch');
    search.addEventListener('input', e => {
      this.searchTerm = e.target.value.toLowerCase();
      this.applyFilters();
      clear.style.display = this.searchTerm ? 'block' : 'none';
    });
    clear.addEventListener('click', () => {
      search.value = '';
      this.searchTerm = '';
      this.applyFilters();
      clear.style.display = 'none';
    });
    document.querySelectorAll('.filter-btn').forEach(btn => btn.addEventListener('click', e => {
      document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      this.currentCategory = e.target.dataset.category;
      this.applyFilters();
    }));
    document.getElementById('closeModal').addEventListener('click', () => document.getElementById('stockModal').classList.remove('active'));
  }

  async loadTickers() {
    if (this.loading) return;
    this.loading = true;
    
    console.log('Polygon API에서 주식 데이터를 로드하는 중...');
    
    try {
      // Polygon API v3를 사용하여 주식 목록 가져오기
      const limit = 50;
      let url = `https://api.polygon.io/v3/reference/tickers?market=stocks&active=true&limit=${limit}&apiKey=${this.apiKey}`;
      if (this.nextCursor) url += `&cursor=${this.nextCursor}`;
      
      console.log('초기 API 호출:', url);
      
      const res = await fetch(url);
      if (!res.ok) {
        console.error('Polygon API 에러', res.status, res.statusText);
        // API 오류 시 더미 데이터로 대체
        this.loadDummyData();
        return;
      }
      
      const json = await res.json();
      const { results, next_page_token } = json;
      
      console.log('초기 API 응답:', { 
        resultsCount: results?.length, 
        nextPageToken: next_page_token,
        hasNextPage: !!next_page_token 
      });
      
      // 다음 페이지 토큰 설정 (무한 스크롤을 위해 중요!)
      this.nextCursor = next_page_token;

      if (!results || results.length === 0) {
        console.warn('API에서 결과가 없습니다. 더미 데이터를 사용합니다.');
        this.loadDummyData();
        return;
      }

      // API 결과를 주식 객체로 변환
      const tickers = results.map(t => ({
        symbol: t.ticker,
        name: t.name,
        marketCap: t.market_cap || 0,
        sector: t.sic_description || t.sector || 'Unknown',
        description: t.description || `${t.name} operates in various markets.`,
        price: 0,
        change: 0,
        changePct: 0,
        volume: 0
      }));

      // 중복 제거 (이미 로드된 심볼 제외)
      const newTickers = tickers.filter(t => !this.loadedSymbols.has(t.symbol));
      
      console.log('초기 로드된 새로운 티커 수:', newTickers.length);
      
      if (newTickers.length === 0) {
        console.log('모든 주식이 이미 로드되었습니다.');
        this.loading = false;
        document.getElementById('loadingIndicator').style.display = 'none';
        return;
      }

      // 가격 정보 로드 (API 호출 제한을 고려하여 일부만)
      const limitedTickers = newTickers.slice(0, 10); // 처음 10개만 가격 정보 로드
      await Promise.all(limitedTickers.map(async s => {
        try {
          const aggRes = await fetch(`https://api.polygon.io/v2/aggs/ticker/${s.symbol}/prev?adjusted=true&apiKey=${this.apiKey}`);
          if (!aggRes.ok) throw new Error(`Agg API ${s.symbol} 에러 ${aggRes.status}`);
          const agg = await aggRes.json();
          const d = agg.results?.[0] || {};
          s.price = d.c || 0;
          s.change = (d.c - d.o) || 0;
          s.changePct = d.o ? ((d.c - d.o) / d.o * 100) : 0;
          s.volume = d.v || 0;
        } catch (err) {
          console.warn(`${s.symbol} 가격 정보 로드 실패:`, err);
          // 가격 정보 로드 실패 시 더미 가격 설정
          s.price = Math.random() * 100 + 10;
          s.change = (Math.random() - 0.5) * 5;
          s.changePct = (Math.random() - 0.5) * 10;
          s.volume = Math.random() * 1000000;
        }
      }));

      // 나머지 티커들에 대해서는 더미 가격 설정
      newTickers.slice(10).forEach(s => {
        s.price = Math.random() * 100 + 10;
        s.change = (Math.random() - 0.5) * 5;
        s.changePct = (Math.random() - 0.5) * 10;
        s.volume = Math.random() * 1000000;
      });

      // 로드된 심볼들을 추적에 추가
      newTickers.forEach(stock => this.loadedSymbols.add(stock.symbol));

      this.stocks.push(...newTickers);
      this.sortByMarketCap();
      this.applyFilters();
      
      console.log('초기 로드 완료:', {
        totalStocks: this.stocks.length,
        nextCursor: this.nextCursor,
        canLoadMore: !!this.nextCursor
      });
      
    } catch (e) {
      console.error('API 로드 오류', e);
      this.loadDummyData();
    } finally {
      this.loading = false;
      document.getElementById('loadingIndicator').style.display = 'none';
    }
  }

  loadDummyData() {
    // API 오류 시 사용할 기본 더미 데이터
    const dummyStocks = [
      { symbol: 'AAPL', name: 'Apple Inc.', marketCap: 3000000000000, sector: 'Technology', description: 'Apple Inc. designs, manufactures, and markets smartphones, personal computers, tablets, wearables, and accessories worldwide.', price: 175.43, change: 2.15, changePct: 1.24, volume: 45000000 },
      { symbol: 'MSFT', name: 'Microsoft Corporation', marketCap: 2800000000000, sector: 'Technology', description: 'Microsoft Corporation develops, licenses, and supports software, services, devices, and solutions worldwide.', price: 378.85, change: -1.23, changePct: -0.32, volume: 22000000 },
      { symbol: 'GOOGL', name: 'Alphabet Inc.', marketCap: 1900000000000, sector: 'Technology', description: 'Alphabet Inc. provides online advertising services in the United States, Europe, the Middle East, Africa, the Asia-Pacific, Canada, and Latin America.', price: 142.56, change: 0.87, changePct: 0.61, volume: 18000000 }
    ];

    // 초기 로드된 심볼들을 추적에 추가
    dummyStocks.forEach(stock => this.loadedSymbols.add(stock.symbol));
    
    this.stocks = dummyStocks;
    this.sortByMarketCap();
    this.applyFilters();
  }

  setupInfiniteScroll() {
    window.addEventListener('scroll', () => {
      const { scrollTop, clientHeight, scrollHeight } = document.documentElement;
      const scrollPercentage = (scrollTop + clientHeight) / scrollHeight;
      
      // 스크롤이 80% 이상 내려갔을 때 로드 시작
      if (scrollPercentage > 0.8 && !this.loading) {
        console.log('무한 스크롤 트리거:', { scrollPercentage, loading: this.loading });
        this.loadMoreStocks();
      }
    });
  }

  async loadMoreStocks() {
    if (this.loading) {
      console.log('이미 로딩 중입니다.');
      return;
    }
    
    console.log('더 많은 주식을 로드하기 시작합니다.');
    this.loading = true;
    
    // 로딩 인디케이터 표시
    const loadingIndicator = document.getElementById('loadingIndicator');
    loadingIndicator.style.display = 'flex';
    loadingIndicator.querySelector('p').textContent = 'Polygon API에서 더 많은 주식을 불러오는 중...';
    
    try {
      // Polygon API에서 추가 주식 데이터 로드
      const additionalStocks = await this.loadMoreFromAPI();
      
      console.log('추가로 로드된 주식 수:', additionalStocks.length);
      
      // 새로운 주식이 있으면 추가
      if (additionalStocks.length > 0) {
        this.stocks.push(...additionalStocks);
        this.sortByMarketCap();
        this.applyFilters();
        loadingIndicator.style.display = 'none';
        console.log('총 주식 수:', this.stocks.length);
      } else {
        // 더 이상 로드할 주식이 없을 때 메시지 표시
        console.log('더 이상 로드할 주식이 없습니다.');
        loadingIndicator.querySelector('p').textContent = '모든 주식을 불러왔습니다!';
        setTimeout(() => {
          loadingIndicator.style.display = 'none';
        }, 2000);
      }
    } catch (error) {
      console.error('추가 주식 로드 오류:', error);
      loadingIndicator.querySelector('p').textContent = 'API 오류로 더미 데이터를 사용합니다.';
      
      // API 오류 시 더미 데이터 사용
      const dummyStocks = this.generateMoreDummyStocks();
      if (dummyStocks.length > 0) {
        this.stocks.push(...dummyStocks);
        this.sortByMarketCap();
        this.applyFilters();
      }
      
      setTimeout(() => {
        loadingIndicator.style.display = 'none';
      }, 2000);
    }
    
    this.loading = false;
    console.log('로딩 완료');
  }

  async loadMoreFromAPI() {
    // 더 이상 API 페이지가 없으면 빈 배열 반환
    if (!this.nextCursor) {
      console.log('더 이상 API 페이지가 없습니다.');
      return [];
    }

    try {
      // API 호출 제한을 피하기 위해 잠시 대기
      await new Promise(resolve => setTimeout(resolve, 1000));
      
      // Polygon API v3를 사용하여 다음 페이지 로드
      const limit = 50;
      const url = `https://api.polygon.io/v3/reference/tickers?market=stocks&active=true&limit=${limit}&cursor=${this.nextCursor}&apiKey=${this.apiKey}`;
      
      console.log('API 호출 중:', url);
      
      const res = await fetch(url);
      if (!res.ok) {
        console.error('Polygon API 에러', res.status, res.statusText);
        
        // API 제한에 걸렸을 경우 더미 데이터 반환
        if (res.status === 429) {
          console.log('API 호출 제한에 걸렸습니다. 더미 데이터를 사용합니다.');
          return this.generateMoreDummyStocks();
        }
        
        return [];
      }
      
      const json = await res.json();
      const { results, next_page_token } = json;
      
      console.log('API 응답:', { resultsCount: results?.length, nextPageToken: next_page_token });
      
      // 다음 페이지 토큰 업데이트
      this.nextCursor = next_page_token;

      if (!results || results.length === 0) {
        console.log('API에서 더 이상 결과가 없습니다.');
        return [];
      }

      // API 결과를 주식 객체로 변환
      const tickers = results.map(t => ({
        symbol: t.ticker,
        name: t.name,
        marketCap: t.market_cap || 0,
        sector: t.sic_description || t.sector || 'Unknown',
        description: t.description || `${t.name} operates in various markets.`,
        price: 0,
        change: 0,
        changePct: 0,
        volume: 0
      }));

      // 중복 제거 (이미 로드된 심볼 제외)
      const newTickers = tickers.filter(t => !this.loadedSymbols.has(t.symbol));
      
      console.log('새로운 티커 수:', newTickers.length);
      
      if (newTickers.length === 0) {
        console.log('모든 주식이 이미 로드되었습니다.');
        return [];
      }

      // 가격 정보 로드 (API 호출 제한을 고려하여 일부만)
      const limitedTickers = newTickers.slice(0, 3); // 처음 3개만 가격 정보 로드 (제한 완화)
      await Promise.all(limitedTickers.map(async s => {
        try {
          // 가격 정보 API 호출 사이에 대기
          await new Promise(resolve => setTimeout(resolve, 200));
          
          const aggRes = await fetch(`https://api.polygon.io/v2/aggs/ticker/${s.symbol}/prev?adjusted=true&apiKey=${this.apiKey}`);
          if (!aggRes.ok) throw new Error(`Agg API ${s.symbol} 에러 ${aggRes.status}`);
          const agg = await aggRes.json();
          const d = agg.results?.[0] || {};
          s.price = d.c || 0;
          s.change = (d.c - d.o) || 0;
          s.changePct = d.o ? ((d.c - d.o) / d.o * 100) : 0;
          s.volume = d.v || 0;
        } catch (err) {
          console.warn(`${s.symbol} 가격 정보 로드 실패:`, err);
          // 가격 정보 로드 실패 시 더미 가격 설정
          s.price = Math.random() * 100 + 10;
          s.change = (Math.random() - 0.5) * 5;
          s.changePct = (Math.random() - 0.5) * 10;
          s.volume = Math.random() * 1000000;
        }
      }));

      // 나머지 티커들에 대해서는 더미 가격 설정
      newTickers.slice(3).forEach(s => {
        s.price = Math.random() * 100 + 10;
        s.change = (Math.random() - 0.5) * 5;
        s.changePct = (Math.random() - 0.5) * 10;
        s.volume = Math.random() * 1000000;
      });

      // 로드된 심볼들을 추적에 추가
      newTickers.forEach(stock => this.loadedSymbols.add(stock.symbol));

      console.log('성공적으로 로드된 주식 수:', newTickers.length);
      return newTickers;
      
    } catch (error) {
      console.error('API 로드 오류:', error);
      // 오류 발생 시 더미 데이터 반환
      return this.generateMoreDummyStocks();
    }
  }

  generateMoreDummyStocks() {
    // API 오류 시 사용할 다양한 더미 데이터
    const dummyStocks = [
      // 기술 섹터
      { symbol: 'AAPL', name: 'Apple Inc.', marketCap: 3000000000000, sector: 'Technology', description: 'Apple Inc. designs, manufactures, and markets smartphones, personal computers, tablets, wearables, and accessories worldwide.', price: 175.43, change: 2.15, changePct: 1.24, volume: 45000000 },
      { symbol: 'MSFT', name: 'Microsoft Corporation', marketCap: 2800000000000, sector: 'Technology', description: 'Microsoft Corporation develops, licenses, and supports software, services, devices, and solutions worldwide.', price: 378.85, change: -1.23, changePct: -0.32, volume: 22000000 },
      { symbol: 'GOOGL', name: 'Alphabet Inc.', marketCap: 1900000000000, sector: 'Technology', description: 'Alphabet Inc. provides online advertising services in the United States, Europe, the Middle East, Africa, the Asia-Pacific, Canada, and Latin America.', price: 142.56, change: 0.87, changePct: 0.61, volume: 18000000 },
      { symbol: 'AMZN', name: 'Amazon.com Inc.', marketCap: 1800000000000, sector: 'Technology', description: 'Amazon.com Inc. engages in the retail sale of consumer products and subscriptions in North America and internationally.', price: 145.67, change: 3.45, changePct: 2.42, volume: 35000000 },
      { symbol: 'TSLA', name: 'Tesla Inc.', marketCap: 800000000000, sector: 'Technology', description: 'Tesla Inc. designs, develops, manufactures, leases, and sells electric vehicles, and energy generation and storage systems.', price: 245.89, change: -5.67, changePct: -2.25, volume: 28000000 },
      
      // 헬스케어 섹터
      { symbol: 'JNJ', name: 'Johnson & Johnson', marketCap: 450000000000, sector: 'Healthcare', description: 'Johnson & Johnson researches, develops, manufactures, and sells various products in the healthcare field worldwide.', price: 168.34, change: 1.23, changePct: 0.74, volume: 12000000 },
      { symbol: 'PFE', name: 'Pfizer Inc.', marketCap: 180000000000, sector: 'Healthcare', description: 'Pfizer Inc. discovers, develops, manufactures, markets, distributes, and sells biopharmaceutical products worldwide.', price: 32.45, change: -0.56, changePct: -1.70, volume: 25000000 },
      { symbol: 'UNH', name: 'UnitedHealth Group Inc.', marketCap: 480000000000, sector: 'Healthcare', description: 'UnitedHealth Group Inc. operates as a diversified health care company in the United States.', price: 520.67, change: 8.90, changePct: 1.74, volume: 8500000 },
      
      // 금융 섹터
      { symbol: 'JPM', name: 'JPMorgan Chase & Co.', marketCap: 520000000000, sector: 'Financial Services', description: 'JPMorgan Chase & Co. operates as a financial services company worldwide.', price: 175.23, change: 2.34, changePct: 1.35, volume: 18000000 },
      { symbol: 'BAC', name: 'Bank of America Corporation', marketCap: 280000000000, sector: 'Financial Services', description: 'Bank of America Corporation provides banking and financial products and services for individuals, small- and middle-market businesses.', price: 34.56, change: -0.23, changePct: -0.66, volume: 42000000 },
      { symbol: 'WFC', name: 'Wells Fargo & Company', marketCap: 180000000000, sector: 'Financial Services', description: 'Wells Fargo & Company provides diversified financial services in the United States.', price: 48.90, change: 0.67, changePct: 1.39, volume: 22000000 },
      
      // 소비재 섹터
      { symbol: 'NFLX', name: 'Netflix Inc.', marketCap: 220000000000, sector: 'Consumer Cyclical', description: 'Netflix Inc. provides entertainment services. It offers TV series, documentaries, feature films, and mobile games.', price: 485.67, change: 8.23, changePct: 1.72, volume: 3800000 },
      { symbol: 'SBUX', name: 'Starbucks Corporation', marketCap: 120000000000, sector: 'Consumer Cyclical', description: 'Starbucks Corporation operates as a roaster, marketer, and retailer of specialty coffee worldwide.', price: 98.45, change: -1.23, changePct: -1.23, volume: 8500000 },
      { symbol: 'NKE', name: 'NIKE Inc.', marketCap: 180000000000, sector: 'Consumer Cyclical', description: 'NIKE Inc. designs, develops, markets, and sells athletic footwear, apparel, equipment, and accessories worldwide.', price: 115.78, change: 2.45, changePct: 2.16, volume: 12000000 },
      
      // 산업재 섹터
      { symbol: 'CAT', name: 'Caterpillar Inc.', marketCap: 120000000000, sector: 'Industrials', description: 'Caterpillar Inc. manufactures and sells construction and mining equipment, diesel and natural gas engines, and industrial gas turbines.', price: 245.67, change: 3.45, changePct: 1.42, volume: 2800000 },
      { symbol: 'BA', name: 'Boeing Company', marketCap: 95000000000, sector: 'Industrials', description: 'Boeing Company designs, develops, manufactures, sells, services, and supports commercial jetliners, military aircraft, satellites, and missile defense.', price: 156.78, change: 1.23, changePct: 0.79, volume: 4200000 },
      { symbol: 'UPS', name: 'United Parcel Service Inc.', marketCap: 140000000000, sector: 'Industrials', description: 'United Parcel Service Inc. provides letter and package delivery, specialized transportation, logistics, and financial services.', price: 165.34, change: -2.67, changePct: -1.59, volume: 3800000 }
    ];

    // 중복 방지를 위해 이미 로드된 심볼 제외
    const newStocks = dummyStocks.filter(stock => !this.loadedSymbols.has(stock.symbol));
    newStocks.forEach(stock => this.loadedSymbols.add(stock.symbol));
    
    console.log('더미 데이터 생성:', newStocks.length, '개');
    return newStocks;
  }

  sortByMarketCap() {
    this.stocks.sort((a, b) => b.marketCap - a.marketCap);
  }

  applyFilters() {
    console.log('필터 적용 중:', { 
      searchTerm: this.searchTerm, 
      currentCategory: this.currentCategory,
      totalStocks: this.stocks.length 
    });
    
    this.filteredStocks = this.stocks.filter(s => {
      const okSearch = !this.searchTerm || s.name.toLowerCase().includes(this.searchTerm) || s.symbol.toLowerCase().includes(this.searchTerm);
      const mappedSector = this.mapSector(s.sector);
      const cat = this.currentCategory === 'all' || mappedSector === this.currentCategory;
      
      // 디버깅을 위한 로그 (처음 5개 주식만)
      if (this.stocks.indexOf(s) < 5) {
        console.log(`주식 ${s.symbol}:`, {
          originalSector: s.sector,
          mappedSector: mappedSector,
          categoryMatch: cat,
          searchMatch: okSearch
        });
      }
      
      return okSearch && cat;
    });
    
    console.log('필터링 결과:', {
      filteredCount: this.filteredStocks.length,
      category: this.currentCategory
    });
    
    this.render();
  }

  mapSector(sector) {
    // 더 정확한 섹터 매핑
    const sectorLower = sector.toLowerCase();
    
    // 기술 섹터
    if (sectorLower.includes('technology') || 
        sectorLower.includes('software') || 
        sectorLower.includes('computer') ||
        sectorLower.includes('internet') ||
        sectorLower.includes('semiconductor') ||
        sectorLower.includes('telecommunications') ||
        sectorLower.includes('communication services') ||
        sectorLower.includes('information technology')) {
      return 'tech';
    }
    
    // 헬스케어 섹터
    if (sectorLower.includes('health') || 
        sectorLower.includes('medical') || 
        sectorLower.includes('pharmaceutical') ||
        sectorLower.includes('biotechnology') ||
        sectorLower.includes('healthcare') ||
        sectorLower.includes('life sciences') ||
        sectorLower.includes('medical devices')) {
      return 'healthcare';
    }
    
    // 금융 섹터
    if (sectorLower.includes('financial') || 
        sectorLower.includes('bank') || 
        sectorLower.includes('insurance') ||
        sectorLower.includes('investment') ||
        sectorLower.includes('real estate') ||
        sectorLower.includes('capital markets') ||
        sectorLower.includes('consumer finance')) {
      return 'finance';
    }
    
    // 소비재 섹터
    if (sectorLower.includes('consumer') || 
        sectorLower.includes('retail') || 
        sectorLower.includes('food') ||
        sectorLower.includes('beverage') ||
        sectorLower.includes('apparel') ||
        sectorLower.includes('entertainment') ||
        sectorLower.includes('hotels') ||
        sectorLower.includes('restaurants') ||
        sectorLower.includes('leisure')) {
      return 'consumer';
    }
    
    // 산업재 섹터
    if (sectorLower.includes('industrial') || 
        sectorLower.includes('manufacturing') || 
        sectorLower.includes('transportation') ||
        sectorLower.includes('aerospace') ||
        sectorLower.includes('defense') ||
        sectorLower.includes('machinery') ||
        sectorLower.includes('energy') ||
        sectorLower.includes('materials') ||
        sectorLower.includes('utilities') ||
        sectorLower.includes('construction')) {
      return 'industrial';
    }
    
    // 기본 매핑
    const map = {
      'Technology': 'tech',
      'Healthcare': 'healthcare',
      'Financial Services': 'finance',
      'Consumer Cyclical': 'consumer',
      'Industrials': 'industrial',
      'Consumer Defensive': 'consumer',
      'Communication Services': 'tech',
      'Energy': 'industrial',
      'Materials': 'industrial',
      'Real Estate': 'finance',
      'Utilities': 'industrial',
      'Unknown': 'all'
    };
    
    return map[sector] || 'all';
  }

  render() {
    const grid = document.getElementById('stocksGrid');
    if (!this.filteredStocks.length) {
      grid.innerHTML = `<div style="grid-column:1/-1;text-align:center;color:var(--text-secondary)"><h3>검색 결과 없음</h3></div>`;
      return;
    }
    grid.innerHTML = this.filteredStocks.map(s => `
      <div class="stock-card" onclick="scs.showDetail('${s.symbol}')">
        <div class="stock-header">
          <div class="stock-info">
            <h3>${s.name}</h3>
            <div class="stock-symbol">${s.symbol}</div>
          </div>
          <div class="stock-category">${this.mapSector(s.sector)}</div>
        </div>
        <div class="stock-price">
          <div class="current-price">$${s.price.toFixed(2)}</div>
          <div class="price-change ${s.change > 0 ? 'positive' : s.change < 0 ? 'negative' : 'neutral'}">
            ${s.change > 0 ? '↗' : '↘'} $${Math.abs(s.change).toFixed(2)} (${s.changePct.toFixed(1)}%)
          </div>
        </div>
      </div>
    `).join('');
  }

  showDetail(symbol) {
    const s = this.stocks.find(x => x.symbol === symbol);
    if (!s) return;
    document.getElementById('modalTitle').textContent = `${s.name} (${s.symbol})`;
    document.getElementById('modalBody').innerHTML = `
      <div class="stock-detail-grid">
        <div class="detail-card"><h4>현재가</h4><p>$${s.price.toFixed(2)}</p></div>
        <div class="detail-card"><h4>변동</h4><p class="${s.change>0?'positive':s.change<0?'negative':'neutral'}">${s.change>0?'↗':'↘'} $${Math.abs(s.change).toFixed(2)} (${s.changePct.toFixed(1)}%)</p></div>
        <div class="detail-card"><h4>시가총액</h4><p>$${(s.marketCap/1e9).toFixed(1)}B</p></div>
        <div class="detail-card"><h4>거래량</h4><p>${(s.volume/1e6).toFixed(1)}M</p></div>
        <div class="detail-card"><h4>업종</h4><p>${s.sector}</p></div>
      </div>
      <div style="margin-top:30px;"><h4>회사 소개</h4><p>${s.description}</p></div>
    `;
    document.getElementById('stockModal').classList.add('active');
  }
}
const scs = new SmallCapStocks();
  </script>
</body>
</html>