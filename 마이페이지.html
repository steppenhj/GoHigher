<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>마이페이지 | Go Higher – 나의 투자 관리, 자산대시보드, 다이어리, 문의내역 한눈에</title>
<meta name="description" content="Go Higher 마이페이지에서 나만의 투자 포트폴리오, 즐겨찾기 종목, 투자 다이어리, 자산 추이, 고객 문의 내역 등 맞춤형 투자 관리 서비스를 제공합니다. 내 미국주식 투자 현황을 한눈에 확인하고 성장 기록을 관리해보세요.">
<meta name="keywords" content="마이페이지, 투자 관리, 포트폴리오, 미국주식 대시보드, 투자 다이어리, 즐겨찾기 종목, 자산 추이, 투자 기록, 투자 문의, Go Higher, 맞춤 투자 서비스, 회원 투자 분석, 주식 자산관리">

<!-- canonical: 실제 마이페이지 경로에 맞게! 예: /마이페이지.html -->
<link rel="canonical" href="https://gohigher.kr/마이페이지.html" />

<!-- 사이트 검증 -->
<meta name="naver-site-verification" content="daa71973aba155bc2d96dfde44d8fb34b6a74ba7" />
<meta name="google-site-verification" content="GGuWsc5cbeYC9W0nQsN7550kWcUzArKuo3zfhjN5LXE" />

<!-- Open Graph (SNS, 카카오/페북 공유 최적화) -->
<meta property="og:type" content="website" />
<meta property="og:title" content="마이페이지 | Go Higher – 나만의 투자 대시보드와 성장 기록" />
<meta property="og:description" content="투자 포트폴리오, 즐겨찾기 종목, 투자 다이어리, 자산 추이, 문의내역까지 내 투자정보를 한눈에 관리! Go Higher 마이페이지에서 성장의 변화를 경험하세요." />
<meta property="og:image" content="https://gohigher.kr/logo.jpg" />
<meta property="og:url" content="https://gohigher.kr/마이페이지.html" />
<meta property="og:site_name" content="Go Higher" />
<meta property="og:locale" content="ko_KR" />

<!-- Twitter Card (트위터/X 공유) -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="마이페이지 | Go Higher – 나만의 투자 대시보드와 성장 기록" />
<meta name="twitter:description" content="나의 투자 현황과 자산, 다이어리, 문의내역을 한곳에서! Go Higher 마이페이지에서 쉽고 편리하게 관리하세요." />
<meta name="twitter:image" content="https://gohigher.kr/logo.jpg" />

<!-- 추가 권장 -->
<meta name="author" content="Go Higher" />
<meta name="robots" content="index,follow" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" href="/logo.jpg" type="image/jpeg" />
    
   <link rel="stylesheet" href="navigation.css">

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700;400&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
    .main-left { width: 370px; min-width: 250px;}
    .main-right { flex: 1; min-width: 210px; display: flex; flex-direction: column; gap: 22px; }
    .profile-box {
      display: flex; align-items: center; gap: 16px; margin-bottom: 34px;
      background: linear-gradient(90deg, #4a70dd 60%, #181f2d 100%);
      padding: 22px 22px 20px 18px; border-radius: 18px;
      box-shadow: 0 8px 30px rgba(70,100,200,0.11);
    }
    .profile-info { flex: 1; }
    .profile-info .name { font-size: 1.25rem; font-weight: 700;}
    .profile-info .email { color: #b7caf8; font-size: 1.02rem;}
    .calendar-box {
      background: #202944; border-radius: 18px; box-shadow: 0 8px 32px rgba(38,48,79,0.22);
      padding: 30px 10px 24px 10px; margin-bottom: 13px; max-width: 370px;
    }
    .calendar-title { font-size: 1.12rem; font-weight: 800; margin-bottom: 17px; color: #ffe066; letter-spacing: 0.03em; }
    .calendar-table { width: 100%; border-collapse: collapse; background: none; }
    .calendar-table th, .calendar-table td { width: 14.3%; text-align: center; font-size: 1.02em; padding: 8px 0;}
    .calendar-table th { color: #98bfff; font-size: 0.97em; }
    .calendar-table td { color: #e9f1ff; font-size: 1.11em; position: relative; }
    .calendar-table td.stamped::before {
      content: "⭐"; position: absolute; left: 50%; top: 53%; transform: translate(-50%,-50%);
      font-size: 1.5em; color: #ffe066; z-index: 2; filter: drop-shadow(0 0 2px #1a2233);
    }
    .calendar-table td.today { outline: 2px solid #ffe066; border-radius: 7px; font-weight: 700; color: #ffe066; background: rgba(255,224,102,0.10);}
    .attendance-summary { text-align: center; color: #ffe066; margin: 7px 0 0 0; font-size: 1.13em; font-weight: 600; }
    .stamp-btn {
      margin-top: 14px; background: linear-gradient(90deg, #ffe066 50%, #ffaf7b 100%);
      color: #1a2233; font-weight: 700; font-size: 1.08em; padding: 12px 0; width: 100%; border: none; border-radius: 13px; cursor: pointer;
      transition: background 0.18s; box-shadow: 0 4px 18px rgba(255,224,102,0.13); letter-spacing:0.01em;
    }
    .stamp-btn[disabled] { filter: grayscale(0.6); opacity: 0.6; cursor: default;}
    .login-guide { text-align: center; color: #98bfff; font-size: 1.12em; margin: 60px 0; }
    .side-card { background: #202944; border-radius: 18px; box-shadow: 0 6px 24px rgba(38,48,79,0.18); padding: 23px 18px; margin-bottom: 0; }
    .side-card-title { font-size: 1.13em; font-weight: 700; margin-bottom: 9px; color: #ffe066;}
    .side-card-bar-bg { background: #26324b; border-radius: 9px; height: 17px; width: 100%; position: relative;}
    .side-card-bar-fill { background: linear-gradient(90deg, #ffe066, #ffaf7b); border-radius: 9px; height: 100%; transition: width .3s;}
    .side-card-badge { background: #ffe066; color: #222; border-radius: 8px; font-size: 0.95em; padding: 3px 10px; font-weight: 600; margin-left: 7px;}
    .side-card-quote { color: #b7caf8; font-size: 1.12em; font-style: italic; line-height: 1.55; }
    .side-card-goal { font-size: 1.07em; color: #e9f1ff;}
    .side-card-goal .goal-label { color: #ffe066; font-size:0.97em;}
    .mypage-main-flex {
  display: flex;
  gap: 32px;
  max-width: 850px;
  margin: 0 auto;
  padding: 44px 6px 28px 6px;
}
    @media (max-width: 850px) {
      .mypage-main-flex { flex-direction: column; max-width: 98vw; gap: 24px;}
      .main-left, .calendar-box { max-width: 100%; width: 100%; }
      .main-right { flex-direction: column; min-width: 0;}

    }
  </style>

</head>
<body>
<nav class="nav">
  <div class="nav-left">
    <button class="hamburger-btn" id="openSidebarBtn" aria-label="메뉴 열기">
      <svg viewBox="0 0 22 22">
        <rect y="4" width="22" height="1.3" rx="0.6" fill="#e9f1ff"/>
        <rect y="10" width="22" height="1.3" rx="0.6" fill="#e9f1ff"/>
        <rect y="16" width="22" height="1.3" rx="0.6" fill="#e9f1ff"/>
      </svg>
    </button>
    <span class="brand">Go Higher</span>
    <div class="nav-menu">
      <a href="/" class="nav-link">홈</a>
      <a href="/뉴스.html" class="nav-link">뉴스</a>
      <a href="/다이어리.html" class="nav-link">다이어리</a>
      <!-- <a href="/시리즈.html" class="nav-link">시리즈</a> -->
      <a href="/멤버십.html" class="nav-link">멤버십</a>
    </div>
  </div>
  <div class="nav-right" id="navRight">
    <div class="stock-search">
  <input
    id="stockSearchInput"
    type="text"
    placeholder="티커/심볼 (예: AAPL, MSFT)"
    autocomplete="off"
    style="width:180px;max-width:220px;"
  />
  <button
    class="btn stock-btn"
    id="stockSearchBtn"
    aria-label="주식 검색"
    title="주식 검색"
    style="margin-left:-2px;"
  >
    <svg xmlns="http://www.w3.org/2000/svg" class="icon-search" viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
      <path fill-rule="evenodd" d="M11 4a7 7 0 014.899 11.899l4.6 4.6a1 1 0 01-1.414 1.414l-4.6-4.6A7 7 0 1111 4zm0 2a5 5 0 100 10 5 5 0 000-10z" clip-rule="evenodd"/>
    </svg>
  </button>
</div>

<button class="btn" id="shareBtn">
  <span style="font-size:1.12em; margin-right:5px; vertical-align:-2px;">🔗</span>
  공유
</button>
    <a href="/login.html" class="btn login" id="loginBtn">로그인</a>
    <img id="profilePhoto" class="profile-photo" src="/logo.jpg" alt="프로필" style="display:none;" />
  </div>
</nav>

  <div class="overlay" id="sidebarOverlay"></div>
  <aside class="sidebar" id="sidebar">
    <button class="sidebar-close" id="closeSidebarBtn" aria-label="닫기">&times;</button>
    <h2>Go Higher 메뉴</h2>
    <div class="user-info">
      <span class="user-icon" style="background:#f0e85a;border-radius:50%;width:36px;height:36px;display:inline-block;vertical-align:middle;overflow:hidden;">
        <img src="" alt="프로필" class="user-photo" style="width:100%;height:100%;object-fit:cover;display:none;">
      </span>
      <div>
        <div class="user-name">비로그인</div>
        <div class="user-email" style="font-size:0.98em; color:#b7caf8; margin-top:2px;"></div>
        <div class="user-status">로그인 필요</div>
      </div>
    </div>
    <hr>
    <div>
      <a href="/마이페이지.html" class="side-link">마이페이지</a>
      <a href="/설정.html" class="side-link">설정</a>
    </div>
    <hr>
        <div>
      <a href="/" class="side-link">홈</a>
      <a href="/뉴스.html" class="side-link">뉴스</a>
      <a href="/다이어리.html" class="side-link">다이어리</a>
      <!-- <a href="/시리즈.html" class="side-link">시리즈</a> -->
      <a href="/멤버십.html" class="side-link">멤버십</a>
    </div>

<a href="/login.html" class="side-link" id="loginLink">로그인</a>
<a href="#" class="side-link" id="logoutLink" style="display:none;">로그아웃</a>

    <hr>
    <div class="biz-info-title">사업자 등록</div>
    <div class="biz-info">GoHigher | 대표 박해진</div>
    <div class="biz-info">대구광역시 북구 동천로 155, 네스빌101동 12층</div>
    <div class="biz-info">사업자번호 407-09-54622</div>
    <div class="biz-info">연락처 070-8080-1675</div>
    <hr>

  <!-- 정책/소개/약관 버튼 -->
  <div class="policy-links" style="margin-top:16px; padding:10px 0 2px 0; display:flex; flex-wrap:wrap; gap:12px; font-size:0.87em; color:#a2b6d8;">
    <a href="푸터/이용약관.html" class="policy-link" style="color:inherit; text-decoration:none;">이용약관</a>
    <a href="푸터/privacy-policy.html" class="policy-link" style="color:inherit; text-decoration:none;">개인정보처리방침</a>
    <a href="푸터/환불정책.html" class="policy-link" style="color:inherit; text-decoration:none;">환불정책</a>
  </div>
  <!-- 저작권 문구 -->
   <div class="copyright" style="margin-top:14px; font-size:11.8px; color:#8e9bb3; text-align:center; letter-spacing:0.01em;">
    © 2025 GoHigher. All rights reserved

</aside>

<!-- 검색 모달 -->
<div id="searchModal" class="search-modal" style="display:none; min-width:370px; max-width:99vw;">
  <button id="closeSearchModal" class="modal-close" aria-label="닫기">&times;</button>
  <h2 class="modal-title" style="margin-bottom:2px;">검색 결과</h2>
  <div id="stockModalTabs"
       style="display:flex; gap:8px; margin:10px 0 20px 0; flex-wrap:wrap;"></div>
  <div id="modalResult" class="stock-result"></div>
</div>

  <div style="height: 66px;"></div>


   <div class="mypage-main-flex">
    <!-- LEFT: 프로필 + 달력 -->
    <div class="main-left">
      <div class="profile-box" id="profileBox" style="display:none;">
        <img id="profilePhoto" class="profile-photo" src="/logo.jpg" alt="프로필">
        <div class="profile-info">
          <div class="name" id="userName">-</div>
          <div class="email" id="userEmail"></div>
        </div>
      </div>
      <div id="calendarBox" class="calendar-box" style="display:none;">
        <div class="calendar-title">이번 달 출석 도장 달력</div>
        <table class="calendar-table" id="calendarTable"></table>
        <div class="attendance-summary" id="attendanceSummary"></div>
        <button class="stamp-btn" id="stampBtn" style="margin-top:18px;">오늘 도장 찍기</button>
      </div>
      <div id="loginGuide" class="login-guide" style="display:none;">
        출석 도장 기능을 사용하려면 <b>로그인</b>이 필요합니다.<br><br>
        <a href="/login.html" style="color:#ffe066;text-decoration:underline;">로그인 페이지로 이동</a>
      </div>
    </div>

    <!-- RIGHT: 미션 진행바, 명언, 자산목표 -->
    <div class="main-right" id="sidePanel" style="display:none;">
      <!-- 출석 미션 진행바 -->
      <div class="side-card" id="missionCard">
        <div class="side-card-title">🎯 출석 미션</div>
        <div style="margin-bottom:8px;font-size:0.98em;color:#b7caf8;">
          이번 달 목표: <b>20일 이상 출석</b> <span id="missionBadge" class="side-card-badge" style="display:none;">달성!</span>
        </div>
        <div class="side-card-bar-bg">
          <div id="missionBar" class="side-card-bar-fill" style="width:0%"></div>
        </div>
<div style="margin-top:8px;font-size:0.96em; color:#b7caf8;">
  현재 <span id="missionCnt" style="color:#ffe066;">0</span>일 / 20일
</div>

      </div>
      <!-- 오늘의 명언 -->
      <div class="side-card">
        <div class="side-card-title">💡 오늘의 성장 명언</div>
        <div id="quoteText" class="side-card-quote"></div>
      </div>
      <!-- 자산 목표 -->
      <div class="side-card">
        <div class="side-card-title">📈 내 자산 목표</div>
        <div id="goalBox" class="side-card-goal">
          <span style="color:#98bfff;">불러오는 중...</span>
        </div>
      </div>
    </div>
  </div>
</main>


  <script src="navigation.js"></script>
  <script>
    // Firebase 설정
    const firebaseConfig = {
      apiKey: "AIzaSyCgFLtAo8LETpHq44hxlT7QigCbIltk-Zk",
      authDomain: "gohigher-55e51.firebaseapp.com",
      projectId: "gohigher-55e51",
      storageBucket: "gohigher-55e51.appspot.com",
      messagingSenderId: "487435343721",
      appId: "1:487435343721:web:dc5708c3a263214fba4ff8",
      measurementId: "G-KQ02L8DXG0"
    };
    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // 명언 배열
    const QUOTES = [
      "성공은 매일의 작은 노력이 쌓여 만들어집니다.",
      "시장보다 먼저 움직이지 말고, 오래 살아남는 법을 배워라.",
      "투자는 미래를 바꾸는 가장 강력한 도구다.",
      "실패를 두려워하지 말고, 계속 시도하라.",
      "복리는 시간과 인내의 보상이다.",
      "큰 변화는 꾸준한 습관에서 시작된다.",
      "분산과 인내, 두 단어만 잊지 마라.",
      "투자 성장은 매일의 기록과 실행에서 온다."
    ];

    // 유틸
    function getTodayStr() {
      const d = new Date();
      return d.toISOString().slice(0,10);
    }
    function renderCalendar(stampArr) {
      const table = document.getElementById('calendarTable');
      table.innerHTML = '';
      const now = new Date();
      const year = now.getFullYear();
      const month = now.getMonth();
      const firstDay = new Date(year, month, 1).getDay();
      const lastDate = new Date(year, month+1, 0).getDate();
      const weekdays = ['일', '월', '화', '수', '목', '금', '토'];
      let tr = document.createElement('tr');
      weekdays.forEach(d=>{ let th=document.createElement('th'); th.textContent=d; tr.appendChild(th); });
      table.appendChild(tr);
      let date = 1;
      for (let r=0;r<6;r++) {
        let row = document.createElement('tr');
        for (let c=0;c<7;c++) {
          let td = document.createElement('td');
          if (r===0 && c<firstDay) {
            td.textContent = '';
          } else if (date > lastDate) {
            td.textContent = '';
          } else {
            td.textContent = date;
            const ymd = `${year}-${String(month+1).padStart(2,'0')}-${String(date).padStart(2,'0')}`;
            if (stampArr.includes(ymd)) td.classList.add('stamped');
            if (ymd === getTodayStr()) td.classList.add('today');
            date++;
          }
          row.appendChild(td);
        }
        table.appendChild(row);
        if (date > lastDate) break;
      }
    }
    async function getAttendance(uid) {
      const doc = await db.collection('users').doc(uid).get();
      return (doc.exists && doc.data().attendance) ? doc.data().attendance : [];
    }
    async function addTodayAttendance(uid) {
      const userRef = db.collection('users').doc(uid);
      const today = getTodayStr();
      await db.runTransaction(async t => {
        const doc = await t.get(userRef);
        let arr = doc.exists && doc.data().attendance ? doc.data().attendance : [];
        if (!arr.includes(today)) {
          arr.push(today);
          t.update(userRef, { attendance: arr });
        }
      });
    }
    async function getUserGoal(uid) {
      const doc = await db.collection('users').doc(uid).get();
      if (!doc.exists) return null;
      const data = doc.data();
      return {
        goal: data.goalAmount,
        current: data.currentAmount
      };
    }

    // --- 마이페이지 동작
    let currentUid = null;
    auth.onAuthStateChanged(async user => {
      const profileBox = document.getElementById('profileBox');
      const calendarBox = document.getElementById('calendarBox');
      const loginGuide = document.getElementById('loginGuide');
      const sidePanel = document.getElementById('sidePanel');
      if (!user) {
        profileBox.style.display = 'none';
        calendarBox.style.display = 'none';
        sidePanel.style.display = 'none';
        loginGuide.style.display = '';
        return;
      }
      profileBox.style.display = '';
      calendarBox.style.display = '';
      sidePanel.style.display = '';
      loginGuide.style.display = 'none';
      document.getElementById('userName').textContent = user.displayName || user.email.split('@')[0];
      document.getElementById('userEmail').textContent = user.email;
      document.getElementById('profilePhoto').src = user.photoURL || '/logo.jpg';
      currentUid = user.uid;

      // 출석데이터 + 사이드패널 정보 렌더
      const arr = await getAttendance(user.uid);
      renderCalendar(arr);
      renderSummary(arr);

      // 사이드: 미션 진행바
      renderMissionBar(arr);

      // 사이드: 명언
      document.getElementById('quoteText').textContent = QUOTES[Math.floor(Math.random()*QUOTES.length)];

      // 사이드: 자산 목표
      const goalData = await getUserGoal(user.uid);
      renderGoalBox(goalData);

      // 오늘 출석 찍기 버튼 (중복 방지)
      const today = getTodayStr();
      const stampBtn = document.getElementById('stampBtn');
      if (arr.includes(today)) {
        stampBtn.textContent = "오늘 이미 출석 도장 완료!";
        stampBtn.disabled = true;
      } else {
        stampBtn.textContent = "오늘 도장 찍기";
        stampBtn.disabled = false;
      }
    });

    // 출석 찍기 이벤트
    document.getElementById('stampBtn').onclick = async function() {
      if (!currentUid) return;
      await addTodayAttendance(currentUid);
      const arr = await getAttendance(currentUid);
      renderCalendar(arr);
      renderSummary(arr);
      renderMissionBar(arr);
      this.textContent = "오늘 이미 출석 도장 완료!";
      this.disabled = true;
    };

    function renderSummary(arr) {
      const now = new Date();
      const prefix = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-`;
      const monthCnt = arr.filter(d=>d.startsWith(prefix)).length;
      document.getElementById('attendanceSummary').textContent = `이번 달 출석: ${monthCnt}회`;
    }
    function renderMissionBar(arr) {
      // 목표: 20일 (수정 가능)
      const now = new Date();
      const prefix = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-`;
      const monthCnt = arr.filter(d=>d.startsWith(prefix)).length;
      const percent = Math.min(100, Math.round((monthCnt/20)*100));
      document.getElementById('missionBar').style.width = percent + "%";
      document.getElementById('missionCnt').textContent = monthCnt;
      if (monthCnt >= 20) {
        document.getElementById('missionBadge').style.display = '';
      } else {
        document.getElementById('missionBadge').style.display = 'none';
      }
    }
    function renderGoalBox(goalData) {
      const el = document.getElementById('goalBox');
      if (!goalData || typeof goalData.goal !== 'number' || typeof goalData.current !== 'number') {
        el.innerHTML = `<span class="goal-label">설정된 자산 목표가 없습니다.<br>
        <span style="font-size:0.96em;">설정은 <b>다이어리</b>에서 가능</span></span>`;
        return;
      }
      const pct = Math.min(100, Math.round((goalData.current/goalData.goal)*100));
      el.innerHTML = `
        <span class="goal-label">목표 금액:</span> ${goalData.goal.toLocaleString()}원<br>
        <span class="goal-label">현재:</span> ${goalData.current.toLocaleString()}원
        <div class="side-card-bar-bg" style="margin:8px 0 3px 0;"><div class="side-card-bar-fill" style="width:${pct}%;"></div></div>
        <span style="color:#ffe066;font-weight:600;">진행률 ${pct}%</span>
      `;
    }
  </script>
</body>
</html>