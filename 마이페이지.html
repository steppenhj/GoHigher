<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë§ˆì´í˜ì´ì§€ | Go Higher â€“ ë‚˜ì˜ íˆ¬ì ê´€ë¦¬, ìì‚°ëŒ€ì‹œë³´ë“œ, ë‹¤ì´ì–´ë¦¬, ë¬¸ì˜ë‚´ì—­ í•œëˆˆì—</title>
<meta name="description" content="Go Higher ë§ˆì´í˜ì´ì§€ì—ì„œ ë‚˜ë§Œì˜ íˆ¬ì í¬íŠ¸í´ë¦¬ì˜¤, ì¦ê²¨ì°¾ê¸° ì¢…ëª©, íˆ¬ì ë‹¤ì´ì–´ë¦¬, ìì‚° ì¶”ì´, ê³ ê° ë¬¸ì˜ ë‚´ì—­ ë“± ë§ì¶¤í˜• íˆ¬ì ê´€ë¦¬ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ë‚´ ë¯¸êµ­ì£¼ì‹ íˆ¬ì í˜„í™©ì„ í•œëˆˆì— í™•ì¸í•˜ê³  ì„±ì¥ ê¸°ë¡ì„ ê´€ë¦¬í•´ë³´ì„¸ìš”.">
<meta name="keywords" content="ë§ˆì´í˜ì´ì§€, íˆ¬ì ê´€ë¦¬, í¬íŠ¸í´ë¦¬ì˜¤, ë¯¸êµ­ì£¼ì‹ ëŒ€ì‹œë³´ë“œ, íˆ¬ì ë‹¤ì´ì–´ë¦¬, ì¦ê²¨ì°¾ê¸° ì¢…ëª©, ìì‚° ì¶”ì´, íˆ¬ì ê¸°ë¡, íˆ¬ì ë¬¸ì˜, Go Higher, ë§ì¶¤ íˆ¬ì ì„œë¹„ìŠ¤, íšŒì› íˆ¬ì ë¶„ì„, ì£¼ì‹ ìì‚°ê´€ë¦¬">

<!-- canonical: ì‹¤ì œ ë§ˆì´í˜ì´ì§€ ê²½ë¡œì— ë§ê²Œ! ì˜ˆ: /ë§ˆì´í˜ì´ì§€.html -->
<link rel="canonical" href="https://gohigher.kr/ë§ˆì´í˜ì´ì§€.html" />

<!-- ì‚¬ì´íŠ¸ ê²€ì¦ -->
<meta name="naver-site-verification" content="daa71973aba155bc2d96dfde44d8fb34b6a74ba7" />
<meta name="google-site-verification" content="GGuWsc5cbeYC9W0nQsN7550kWcUzArKuo3zfhjN5LXE" />

<!-- Open Graph (SNS, ì¹´ì¹´ì˜¤/í˜ë¶ ê³µìœ  ìµœì í™”) -->
<meta property="og:type" content="website" />
<meta property="og:title" content="ë§ˆì´í˜ì´ì§€ | Go Higher â€“ ë‚˜ë§Œì˜ íˆ¬ì ëŒ€ì‹œë³´ë“œì™€ ì„±ì¥ ê¸°ë¡" />
<meta property="og:description" content="íˆ¬ì í¬íŠ¸í´ë¦¬ì˜¤, ì¦ê²¨ì°¾ê¸° ì¢…ëª©, íˆ¬ì ë‹¤ì´ì–´ë¦¬, ìì‚° ì¶”ì´, ë¬¸ì˜ë‚´ì—­ê¹Œì§€ ë‚´ íˆ¬ìì •ë³´ë¥¼ í•œëˆˆì— ê´€ë¦¬! Go Higher ë§ˆì´í˜ì´ì§€ì—ì„œ ì„±ì¥ì˜ ë³€í™”ë¥¼ ê²½í—˜í•˜ì„¸ìš”." />
<meta property="og:image" content="https://gohigher.kr/logo.jpg" />
<meta property="og:url" content="https://gohigher.kr/ë§ˆì´í˜ì´ì§€.html" />
<meta property="og:site_name" content="Go Higher" />
<meta property="og:locale" content="ko_KR" />

<!-- Twitter Card (íŠ¸ìœ„í„°/X ê³µìœ ) -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="ë§ˆì´í˜ì´ì§€ | Go Higher â€“ ë‚˜ë§Œì˜ íˆ¬ì ëŒ€ì‹œë³´ë“œì™€ ì„±ì¥ ê¸°ë¡" />
<meta name="twitter:description" content="ë‚˜ì˜ íˆ¬ì í˜„í™©ê³¼ ìì‚°, ë‹¤ì´ì–´ë¦¬, ë¬¸ì˜ë‚´ì—­ì„ í•œê³³ì—ì„œ! Go Higher ë§ˆì´í˜ì´ì§€ì—ì„œ ì‰½ê³  í¸ë¦¬í•˜ê²Œ ê´€ë¦¬í•˜ì„¸ìš”." />
<meta name="twitter:image" content="https://gohigher.kr/logo.jpg" />

<!-- ì¶”ê°€ ê¶Œì¥ -->
<meta name="author" content="Go Higher" />
<meta name="robots" content="index,follow" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" href="/logo.jpg" type="image/jpeg" />
    
   <link rel="stylesheet" href="navigation.css">

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700;400&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
    .main-left { width: 370px; min-width: 250px;}
    .main-right { flex: 1; min-width: 210px; display: flex; flex-direction: column; gap: 22px; }
    .profile-box {
      display: flex; align-items: center; gap: 16px; margin-bottom: 34px;
      background: linear-gradient(90deg, #4a70dd 60%, #181f2d 100%);
      padding: 22px 22px 20px 18px; border-radius: 18px;
      box-shadow: 0 8px 30px rgba(70,100,200,0.11);
    }
    .profile-info { flex: 1; }
    .profile-info .name { font-size: 1.25rem; font-weight: 700;}
    .profile-info .email { color: #b7caf8; font-size: 1.02rem;}
    .calendar-box {
      background: #202944; border-radius: 18px; box-shadow: 0 8px 32px rgba(38,48,79,0.22);
      padding: 30px 10px 24px 10px; margin-bottom: 13px; max-width: 370px;
    }
    .calendar-title { font-size: 1.12rem; font-weight: 800; margin-bottom: 17px; color: #ffe066; letter-spacing: 0.03em; }
    .calendar-table { width: 100%; border-collapse: collapse; background: none; }
    .calendar-table th, .calendar-table td { width: 14.3%; text-align: center; font-size: 1.02em; padding: 8px 0;}
    .calendar-table th { color: #98bfff; font-size: 0.97em; }
    .calendar-table td { color: #e9f1ff; font-size: 1.11em; position: relative; }
    .calendar-table td.stamped::before {
      content: "â­"; position: absolute; left: 50%; top: 53%; transform: translate(-50%,-50%);
      font-size: 1.5em; color: #ffe066; z-index: 2; filter: drop-shadow(0 0 2px #1a2233);
    }
    .calendar-table td.today { outline: 2px solid #ffe066; border-radius: 7px; font-weight: 700; color: #ffe066; background: rgba(255,224,102,0.10);}
    .attendance-summary { text-align: center; color: #ffe066; margin: 7px 0 0 0; font-size: 1.13em; font-weight: 600; }
    .stamp-btn {
      margin-top: 14px; background: linear-gradient(90deg, #ffe066 50%, #ffaf7b 100%);
      color: #1a2233; font-weight: 700; font-size: 1.08em; padding: 12px 0; width: 100%; border: none; border-radius: 13px; cursor: pointer;
      transition: background 0.18s; box-shadow: 0 4px 18px rgba(255,224,102,0.13); letter-spacing:0.01em;
    }
    .stamp-btn[disabled] { filter: grayscale(0.6); opacity: 0.6; cursor: default;}
    .login-guide { text-align: center; color: #98bfff; font-size: 1.12em; margin: 60px 0; }
    .side-card { background: #202944; border-radius: 18px; box-shadow: 0 6px 24px rgba(38,48,79,0.18); padding: 23px 18px; margin-bottom: 0; }
    .side-card-title { font-size: 1.13em; font-weight: 700; margin-bottom: 9px; color: #ffe066;}
    .side-card-bar-bg { background: #26324b; border-radius: 9px; height: 17px; width: 100%; position: relative;}
    .side-card-bar-fill { background: linear-gradient(90deg, #ffe066, #ffaf7b); border-radius: 9px; height: 100%; transition: width .3s;}
    .side-card-badge { background: #ffe066; color: #222; border-radius: 8px; font-size: 0.95em; padding: 3px 10px; font-weight: 600; margin-left: 7px;}
    .side-card-quote { color: #b7caf8; font-size: 1.12em; font-style: italic; line-height: 1.55; }
    .side-card-goal { font-size: 1.07em; color: #e9f1ff;}
    .side-card-goal .goal-label { color: #ffe066; font-size:0.97em;}
    .mypage-main-flex {
  display: flex;
  gap: 32px;
  max-width: 850px;
  margin: 0 auto;
  padding: 44px 6px 28px 6px;
}
    @media (max-width: 850px) {
      .mypage-main-flex { flex-direction: column; max-width: 98vw; gap: 24px;}
      .main-left, .calendar-box { max-width: 100%; width: 100%; }
      .main-right { flex-direction: column; min-width: 0;}

    }
  </style>

</head>
<body>
<nav class="nav">
  <div class="nav-left">
    <button class="hamburger-btn" id="openSidebarBtn" aria-label="ë©”ë‰´ ì—´ê¸°">
      <svg viewBox="0 0 22 22">
        <rect y="4" width="22" height="1.3" rx="0.6" fill="#e9f1ff"/>
        <rect y="10" width="22" height="1.3" rx="0.6" fill="#e9f1ff"/>
        <rect y="16" width="22" height="1.3" rx="0.6" fill="#e9f1ff"/>
      </svg>
    </button>
    <span class="brand">Go Higher</span>
    <div class="nav-menu">
      <a href="/" class="nav-link">í™ˆ</a>
      <a href="/ë‰´ìŠ¤.html" class="nav-link">ë‰´ìŠ¤</a>
      <a href="/ë‹¤ì´ì–´ë¦¬.html" class="nav-link">ë‹¤ì´ì–´ë¦¬</a>
      <a href="/ì‹œë¦¬ì¦ˆ.html" class="nav-link">ì‹œë¦¬ì¦ˆ</a>
      <!-- <a href="/ë©¤ë²„ì‹­.html" class="nav-link">ë©¤ë²„ì‹­</a> -->
    </div>
  </div>
  <div class="nav-right" id="navRight">
    <div class="stock-search">
  <input
    id="stockSearchInput"
    type="text"
    placeholder="í‹°ì»¤/ì‹¬ë³¼ (ì˜ˆ: AAPL, MSFT)"
    autocomplete="off"
    style="width:180px;max-width:220px;"
  />
  <button
    class="btn stock-btn"
    id="stockSearchBtn"
    aria-label="ì£¼ì‹ ê²€ìƒ‰"
    title="ì£¼ì‹ ê²€ìƒ‰"
    style="margin-left:-2px;"
  >
    <svg xmlns="http://www.w3.org/2000/svg" class="icon-search" viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
      <path fill-rule="evenodd" d="M11 4a7 7 0 014.899 11.899l4.6 4.6a1 1 0 01-1.414 1.414l-4.6-4.6A7 7 0 1111 4zm0 2a5 5 0 100 10 5 5 0 000-10z" clip-rule="evenodd"/>
    </svg>
  </button>
</div>

<button class="btn" id="shareBtn">
  <span style="font-size:1.12em; margin-right:5px; vertical-align:-2px;">ğŸ”—</span>
  ê³µìœ 
</button>
    <a href="/login.html" class="btn login" id="loginBtn">ë¡œê·¸ì¸</a>
    <img id="profilePhoto" class="profile-photo" src="/logo.jpg" alt="í”„ë¡œí•„" style="display:none;" />
  </div>
</nav>

  <div class="overlay" id="sidebarOverlay"></div>
  <aside class="sidebar" id="sidebar">
    <button class="sidebar-close" id="closeSidebarBtn" aria-label="ë‹«ê¸°">&times;</button>
    <h2>Go Higher ë©”ë‰´</h2>
    <div class="user-info">
      <span class="user-icon" style="background:#f0e85a;border-radius:50%;width:36px;height:36px;display:inline-block;vertical-align:middle;overflow:hidden;">
        <img src="" alt="í”„ë¡œí•„" class="user-photo" style="width:100%;height:100%;object-fit:cover;display:none;">
      </span>
      <div>
        <div class="user-name">ë¹„ë¡œê·¸ì¸</div>
        <div class="user-email" style="font-size:0.98em; color:#b7caf8; margin-top:2px;"></div>
        <div class="user-status">ë¡œê·¸ì¸ í•„ìš”</div>
      </div>
    </div>
    <hr>
    <div>
      <a href="/ë§ˆì´í˜ì´ì§€.html" class="side-link">ë§ˆì´í˜ì´ì§€</a>
      <a href="/ì„¤ì •.html" class="side-link">ì„¤ì •</a>
    </div>
    <hr>
        <div>
      <a href="/" class="side-link">í™ˆ</a>
      <a href="/ë‰´ìŠ¤.html" class="side-link">ë‰´ìŠ¤</a>
      <a href="/ë‹¤ì´ì–´ë¦¬.html" class="side-link">ë‹¤ì´ì–´ë¦¬</a>
      <a href="/ì‹œë¦¬ì¦ˆ.html" class="side-link">ì‹œë¦¬ì¦ˆ</a>
      <!-- <a href="/ë©¤ë²„ì‹­.html" class="side-link">ë©¤ë²„ì‹­</a> -->
    </div>

<a href="/login.html" class="side-link" id="loginLink">ë¡œê·¸ì¸</a>
<a href="#" class="side-link" id="logoutLink" style="display:none;">ë¡œê·¸ì•„ì›ƒ</a>

    <!-- <hr>
    <div class="biz-info-title">ì‚¬ì—…ì ë“±ë¡</div>
    <div class="biz-info">GoHigher | ëŒ€í‘œ ë°•í•´ì§„</div>
    <div class="biz-info">ëŒ€êµ¬ê´‘ì—­ì‹œ ë¶êµ¬ ë™ì²œë¡œ 155, ë„¤ìŠ¤ë¹Œ101ë™ 12ì¸µ</div>
    <div class="biz-info">ì‚¬ì—…ìë²ˆí˜¸ 407-09-54622</div>
    <div class="biz-info">ì—°ë½ì²˜ 070-8080-1675</div>
    <hr> -->

  <!-- ì •ì±…/ì†Œê°œ/ì•½ê´€ ë²„íŠ¼ -->
  <div class="policy-links" style="margin-top:16px; padding:10px 0 2px 0; display:flex; flex-wrap:wrap; gap:12px; font-size:0.87em; color:#a2b6d8;">
    <a href="í‘¸í„°/ì´ìš©ì•½ê´€.html" class="policy-link" style="color:inherit; text-decoration:none;">ì´ìš©ì•½ê´€</a>
    <a href="í‘¸í„°/privacy-policy.html" class="policy-link" style="color:inherit; text-decoration:none;">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>
    <a href="í‘¸í„°/í™˜ë¶ˆì •ì±….html" class="policy-link" style="color:inherit; text-decoration:none;">í™˜ë¶ˆì •ì±…</a>
  </div>
  <!-- ì €ì‘ê¶Œ ë¬¸êµ¬ -->
   <div class="copyright" style="margin-top:14px; font-size:11.8px; color:#8e9bb3; text-align:center; letter-spacing:0.01em;">
    Â© 2025 GoHigher. All rights reserved

</aside>

<!-- ê²€ìƒ‰ ëª¨ë‹¬ -->
<div id="searchModal" class="search-modal" style="display:none; min-width:370px; max-width:99vw;">
  <button id="closeSearchModal" class="modal-close" aria-label="ë‹«ê¸°">&times;</button>
  <h2 class="modal-title" style="margin-bottom:2px;">ê²€ìƒ‰ ê²°ê³¼</h2>
  <div id="stockModalTabs"
       style="display:flex; gap:8px; margin:10px 0 20px 0; flex-wrap:wrap;"></div>
  <div id="modalResult" class="stock-result"></div>
</div>

  <div style="height: 66px;"></div>


   <div class="mypage-main-flex">
    <!-- LEFT: í”„ë¡œí•„ + ë‹¬ë ¥ -->
    <div class="main-left">
      <div class="profile-box" id="profileBox" style="display:none;">
        <img id="profilePhoto" class="profile-photo" src="/logo.jpg" alt="í”„ë¡œí•„">
        <div class="profile-info">
          <div class="name" id="userName">-</div>
          <div class="email" id="userEmail"></div>
        </div>
      </div>
      <div id="calendarBox" class="calendar-box" style="display:none;">
        <div class="calendar-title">ì´ë²ˆ ë‹¬ ì¶œì„ ë„ì¥ ë‹¬ë ¥</div>
        <table class="calendar-table" id="calendarTable"></table>
        <div class="attendance-summary" id="attendanceSummary"></div>
        <button class="stamp-btn" id="stampBtn" style="margin-top:18px;">ì˜¤ëŠ˜ ë„ì¥ ì°ê¸°</button>
      </div>
      <div id="loginGuide" class="login-guide" style="display:none;">
        ì¶œì„ ë„ì¥ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ <b>ë¡œê·¸ì¸</b>ì´ í•„ìš”í•©ë‹ˆë‹¤.<br><br>
        <a href="/login.html" style="color:#ffe066;text-decoration:underline;">ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™</a>
      </div>
    </div>

    <!-- RIGHT: ë¯¸ì…˜ ì§„í–‰ë°”, ëª…ì–¸, ìì‚°ëª©í‘œ -->
    <div class="main-right" id="sidePanel" style="display:none;">
      <!-- ì¶œì„ ë¯¸ì…˜ ì§„í–‰ë°” -->
      <div class="side-card" id="missionCard">
        <div class="side-card-title">ğŸ¯ ì¶œì„ ë¯¸ì…˜</div>
        <div style="margin-bottom:8px;font-size:0.98em;color:#b7caf8;">
          ì´ë²ˆ ë‹¬ ëª©í‘œ: <b>20ì¼ ì´ìƒ ì¶œì„</b> <span id="missionBadge" class="side-card-badge" style="display:none;">ë‹¬ì„±!</span>
        </div>
        <div class="side-card-bar-bg">
          <div id="missionBar" class="side-card-bar-fill" style="width:0%"></div>
        </div>
<div style="margin-top:8px;font-size:0.96em; color:#b7caf8;">
  í˜„ì¬ <span id="missionCnt" style="color:#ffe066;">0</span>ì¼ / 20ì¼
</div>

      </div>
      <!-- ì˜¤ëŠ˜ì˜ ëª…ì–¸ -->
      <div class="side-card">
        <div class="side-card-title">ğŸ’¡ ì˜¤ëŠ˜ì˜ ì„±ì¥ ëª…ì–¸</div>
        <div id="quoteText" class="side-card-quote"></div>
      </div>
      <!-- ìì‚° ëª©í‘œ -->
      <div class="side-card">
        <div class="side-card-title">ğŸ“ˆ ë‚´ ìì‚° ëª©í‘œ</div>
        <div id="goalBox" class="side-card-goal">
          <span style="color:#98bfff;">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span>
        </div>
      </div>
    </div>
  </div>
</main>


  <script src="navigation.js"></script>
  <script>
    // Firebase ì„¤ì •
    const firebaseConfig = {
      apiKey: "AIzaSyCgFLtAo8LETpHq44hxlT7QigCbIltk-Zk",
      authDomain: "gohigher-55e51.firebaseapp.com",
      projectId: "gohigher-55e51",
      storageBucket: "gohigher-55e51.appspot.com",
      messagingSenderId: "487435343721",
      appId: "1:487435343721:web:dc5708c3a263214fba4ff8",
      measurementId: "G-KQ02L8DXG0"
    };
    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // ëª…ì–¸ ë°°ì—´
    const QUOTES = [
      "ì„±ê³µì€ ë§¤ì¼ì˜ ì‘ì€ ë…¸ë ¥ì´ ìŒ“ì—¬ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤.",
      "ì‹œì¥ë³´ë‹¤ ë¨¼ì € ì›€ì§ì´ì§€ ë§ê³ , ì˜¤ë˜ ì‚´ì•„ë‚¨ëŠ” ë²•ì„ ë°°ì›Œë¼.",
      "íˆ¬ìëŠ” ë¯¸ë˜ë¥¼ ë°”ê¾¸ëŠ” ê°€ì¥ ê°•ë ¥í•œ ë„êµ¬ë‹¤.",
      "ì‹¤íŒ¨ë¥¼ ë‘ë ¤ì›Œí•˜ì§€ ë§ê³ , ê³„ì† ì‹œë„í•˜ë¼.",
      "ë³µë¦¬ëŠ” ì‹œê°„ê³¼ ì¸ë‚´ì˜ ë³´ìƒì´ë‹¤.",
      "í° ë³€í™”ëŠ” ê¾¸ì¤€í•œ ìŠµê´€ì—ì„œ ì‹œì‘ëœë‹¤.",
      "ë¶„ì‚°ê³¼ ì¸ë‚´, ë‘ ë‹¨ì–´ë§Œ ìŠì§€ ë§ˆë¼.",
      "íˆ¬ì ì„±ì¥ì€ ë§¤ì¼ì˜ ê¸°ë¡ê³¼ ì‹¤í–‰ì—ì„œ ì˜¨ë‹¤."
    ];

    // ìœ í‹¸
    function getTodayStr() {
      const d = new Date();
      return d.toISOString().slice(0,10);
    }
    function renderCalendar(stampArr) {
      const table = document.getElementById('calendarTable');
      table.innerHTML = '';
      const now = new Date();
      const year = now.getFullYear();
      const month = now.getMonth();
      const firstDay = new Date(year, month, 1).getDay();
      const lastDate = new Date(year, month+1, 0).getDate();
      const weekdays = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
      let tr = document.createElement('tr');
      weekdays.forEach(d=>{ let th=document.createElement('th'); th.textContent=d; tr.appendChild(th); });
      table.appendChild(tr);
      let date = 1;
      for (let r=0;r<6;r++) {
        let row = document.createElement('tr');
        for (let c=0;c<7;c++) {
          let td = document.createElement('td');
          if (r===0 && c<firstDay) {
            td.textContent = '';
          } else if (date > lastDate) {
            td.textContent = '';
          } else {
            td.textContent = date;
            const ymd = `${year}-${String(month+1).padStart(2,'0')}-${String(date).padStart(2,'0')}`;
            if (stampArr.includes(ymd)) td.classList.add('stamped');
            if (ymd === getTodayStr()) td.classList.add('today');
            date++;
          }
          row.appendChild(td);
        }
        table.appendChild(row);
        if (date > lastDate) break;
      }
    }
    async function getAttendance(uid) {
      const doc = await db.collection('users').doc(uid).get();
      return (doc.exists && doc.data().attendance) ? doc.data().attendance : [];
    }
    async function addTodayAttendance(uid) {
      const userRef = db.collection('users').doc(uid);
      const today = getTodayStr();
      await db.runTransaction(async t => {
        const doc = await t.get(userRef);
        let arr = doc.exists && doc.data().attendance ? doc.data().attendance : [];
        if (!arr.includes(today)) {
          arr.push(today);
          t.update(userRef, { attendance: arr });
        }
      });
    }
    async function getUserGoal(uid) {
      const doc = await db.collection('users').doc(uid).get();
      if (!doc.exists) return null;
      const data = doc.data();
      return {
        goal: data.goalAmount,
        current: data.currentAmount
      };
    }

    // --- ë§ˆì´í˜ì´ì§€ ë™ì‘
    let currentUid = null;
    auth.onAuthStateChanged(async user => {
      const profileBox = document.getElementById('profileBox');
      const calendarBox = document.getElementById('calendarBox');
      const loginGuide = document.getElementById('loginGuide');
      const sidePanel = document.getElementById('sidePanel');
      if (!user) {
        profileBox.style.display = 'none';
        calendarBox.style.display = 'none';
        sidePanel.style.display = 'none';
        loginGuide.style.display = '';
        return;
      }
      profileBox.style.display = '';
      calendarBox.style.display = '';
      sidePanel.style.display = '';
      loginGuide.style.display = 'none';
      document.getElementById('userName').textContent = user.displayName || user.email.split('@')[0];
      document.getElementById('userEmail').textContent = user.email;
      document.getElementById('profilePhoto').src = user.photoURL || '/logo.jpg';
      currentUid = user.uid;

      // ì¶œì„ë°ì´í„° + ì‚¬ì´ë“œíŒ¨ë„ ì •ë³´ ë Œë”
      const arr = await getAttendance(user.uid);
      renderCalendar(arr);
      renderSummary(arr);

      // ì‚¬ì´ë“œ: ë¯¸ì…˜ ì§„í–‰ë°”
      renderMissionBar(arr);

      // ì‚¬ì´ë“œ: ëª…ì–¸
      document.getElementById('quoteText').textContent = QUOTES[Math.floor(Math.random()*QUOTES.length)];

      // ì‚¬ì´ë“œ: ìì‚° ëª©í‘œ
      const goalData = await getUserGoal(user.uid);
      renderGoalBox(goalData);

      // ì˜¤ëŠ˜ ì¶œì„ ì°ê¸° ë²„íŠ¼ (ì¤‘ë³µ ë°©ì§€)
      const today = getTodayStr();
      const stampBtn = document.getElementById('stampBtn');
      if (arr.includes(today)) {
        stampBtn.textContent = "ì˜¤ëŠ˜ ì´ë¯¸ ì¶œì„ ë„ì¥ ì™„ë£Œ!";
        stampBtn.disabled = true;
      } else {
        stampBtn.textContent = "ì˜¤ëŠ˜ ë„ì¥ ì°ê¸°";
        stampBtn.disabled = false;
      }
    });

    // ì¶œì„ ì°ê¸° ì´ë²¤íŠ¸
    document.getElementById('stampBtn').onclick = async function() {
      if (!currentUid) return;
      await addTodayAttendance(currentUid);
      const arr = await getAttendance(currentUid);
      renderCalendar(arr);
      renderSummary(arr);
      renderMissionBar(arr);
      this.textContent = "ì˜¤ëŠ˜ ì´ë¯¸ ì¶œì„ ë„ì¥ ì™„ë£Œ!";
      this.disabled = true;
    };

    function renderSummary(arr) {
      const now = new Date();
      const prefix = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-`;
      const monthCnt = arr.filter(d=>d.startsWith(prefix)).length;
      document.getElementById('attendanceSummary').textContent = `ì´ë²ˆ ë‹¬ ì¶œì„: ${monthCnt}íšŒ`;
    }
    function renderMissionBar(arr) {
      // ëª©í‘œ: 20ì¼ (ìˆ˜ì • ê°€ëŠ¥)
      const now = new Date();
      const prefix = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-`;
      const monthCnt = arr.filter(d=>d.startsWith(prefix)).length;
      const percent = Math.min(100, Math.round((monthCnt/20)*100));
      document.getElementById('missionBar').style.width = percent + "%";
      document.getElementById('missionCnt').textContent = monthCnt;
      if (monthCnt >= 20) {
        document.getElementById('missionBadge').style.display = '';
      } else {
        document.getElementById('missionBadge').style.display = 'none';
      }
    }
    function renderGoalBox(goalData) {
      const el = document.getElementById('goalBox');
      if (!goalData || typeof goalData.goal !== 'number' || typeof goalData.current !== 'number') {
        el.innerHTML = `<span class="goal-label">ì„¤ì •ëœ ìì‚° ëª©í‘œê°€ ì—†ìŠµë‹ˆë‹¤.<br>
        <span style="font-size:0.96em;">ì„¤ì •ì€ <b>ë‹¤ì´ì–´ë¦¬</b>ì—ì„œ ê°€ëŠ¥</span></span>`;
        return;
      }
      const pct = Math.min(100, Math.round((goalData.current/goalData.goal)*100));
      el.innerHTML = `
        <span class="goal-label">ëª©í‘œ ê¸ˆì•¡:</span> ${goalData.goal.toLocaleString()}ì›<br>
        <span class="goal-label">í˜„ì¬:</span> ${goalData.current.toLocaleString()}ì›
        <div class="side-card-bar-bg" style="margin:8px 0 3px 0;"><div class="side-card-bar-fill" style="width:${pct}%;"></div></div>
        <span style="color:#ffe066;font-weight:600;">ì§„í–‰ë¥  ${pct}%</span>
      `;
    }
  </script>
</body>
</html>