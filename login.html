<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>회원로그인</title>
  <!-- Google Fonts: Roboto -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,700&display=swap" rel="stylesheet">
  <style>
    /* CSS Variables for 색상 관리 */
    :root {
      --primary-color: #4285F4;
      --secondary-color: #357ae8;
      --accent-color: #ffd700;
      --background-overlay: rgb(255, 255, 255);
      --text-color: #333;
    }
    /* 글로벌 리셋 */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Roboto', sans-serif;
      color: var(--text-color);
      padding: 20px;
      background: url('background.png') no-repeat center center fixed;
      background-size: cover;
      min-height: 100vh;
    }
    /* 컨테이너 레이아웃 */
    .container {
      display: flex;
      justify-content: space-between;
      gap: 20px;
      max-width: 1200px;
      margin: 40px auto;
    }
    .left-panel {
      position: relative;
      flex: 2;
      background: none;
      padding: 30px;
      font-size: 1.1rem;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    .left-panel::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(255,255,255,0.7));
  clip-path: url(#puzzleClip);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
  z-index: -1;
  pointer-events: none;
}

    /* 오른쪽 패널: 상대적으로 좁게 */
    .right-panel {
      flex: 1;
      background: none;
      border-radius: 12px;
      padding: 30px;
    }
    @media (max-width: 768px) {
      .container {
        flex-direction: column;
      }
      .left-panel {
    padding: 10px;
    overflow: hidden; /* 내용이 넘치지 않도록 */
    text-align: center;
  }

  /* 정보 박스 내 텍스트 스타일 조정 */
  .left-panel .info-box {
    width: 90%;
    margin: 0 auto;
    font-size: 0.9rem; /* 기본 폰트 크기 축소 */
  }
  .left-panel .info-box h2 {
    font-size: 1.2rem !important; /* 제목 폰트 크기 조정 */
    margin-top: 100px !important;
  }
  .left-panel .info-box li {
    font-size: 0.8rem !important; /* 리스트 항목 폰트 크기 축소 */
    margin-top: 0.2rem !important;
    margin-bottom: 10px !important;
  }

  /* 인트로 메시지 스타일 조정 */
  .left-panel .intro-message {
    width: 90%;
    font-size: 1.2rem !important; /* 폰트 크기 축소 */
    margin-bottom: 100px !important;
  }
  .left-panel .info-box ol {
  list-style: decimal inside;  /* 번호를 안쪽에 표시, 또는 decimal로 유지 가능 */
  margin: 0 auto;              /* 가로 방향 중앙 정렬 */
  display: inline-block;       /* 블록 폭을 내용물에 맞춤 */
  text-align: left;            /* 항목 내부 텍스트는 왼쪽 정렬 */
  padding: 0;                  /* 기본 padding 제거 (필요 시 조절) */
}

.left-panel .info-box ol li {
  margin-bottom: 10px;
  font-size: 1.3rem;  /* 기존 스타일 유지 */
  /* 필요에 따라 추가 스타일 조정 가능 */
}
}
 
    h1 {
      text-align: center;
      color: white;
      font-size: 2rem;
      margin-bottom: 20px;
    }
    /* 정보 박스 스타일 (왼쪽 패널) */
    .info-box {
      margin-bottom: 30px;
    }
    .left-panel .info-box h2 {
      font-size: 2rem; /* 글자 크기 확대 */
      margin-bottom: 4rem;
      margin-top: 2rem;
      color: var(--primary-color);
    }
    .left-panel .info-box ol {
      list-style: decimal;
      padding-left: 20px;
    }
    .left-panel .info-box li {
      margin-bottom: 10px;
      font-size: 1.3rem; /* 글자 크기 확대 */
    }
    /* 인트로 메시지 (왼쪽 패널) */
    .left-panel .intro-message {
      text-align: center;
      font-size: 1.8rem; /* 글자 크기 확대 */
      color: var(--primary-color);
      margin-bottom: 2rem;
    }
    .wave-text {
      display: inline-block;
      font-size: 2.5rem;
      font-weight: bold;
      color: var(--accent-color);
      text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
      margin-right: 10px;
    }
    .bottom-text{
      font-weight: bold;
    }
    @keyframes wave {
      0%, 40%, 100% { transform: translateY(0); }
      20% { transform: translateY(-10px); }
    }
    .wave-text span {
      display: inline-block;
      animation: wave 1.5s infinite;
      animation-delay: calc(0.1s * var(--i));
    }
    /* 탭 버튼 그룹 */
    .tab-buttons {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }
    .tab {
      flex: 1;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      background: #eee;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .tab.active {
      background: var(--primary-color);
      color: #fff;
    }
    /* 탭 패널 */
    .tab-panel {
      background: #fff;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }
    .tab-panel h2 {
      color: var(--primary-color);
      margin-bottom: 15px;
      font-size: 1.3rem;
    }
    .tab-panel input,
    .tab-panel button {
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
    }
    .tab-panel button {
      background: var(--primary-color);
      color: #fff;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .tab-panel button:hover {
      background: var(--secondary-color);
    }
    .hidden { display: none; }
    /* 구분선 스타일 */
    .divider {
      text-align: center;
      margin: 20px 0;
      position: relative;
      font-size: 0.95rem;
      font-weight: bold;
      color: white;
    }
    .divider::before, .divider::after {
      content: "";
      position: absolute;
      top: 50%;
      width: 25%;
      height: 3px;
      background: white;
    }
    .divider::before { left: 0; }
    .divider::after { right: 0; }
    /* 구글 로그인 버튼 */
    .login-container {
      text-align: center;
    }
    .google-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: var(--primary-color);
      color: #fff;
      border: none;
      border-radius: 30px;
      padding: 12px 20px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s, box-shadow 0.3s;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
    }
    .google-btn img {
      width: 30px;
      height: 30px;
      margin-right: 10px;
    }
    .google-btn:hover {
      background: var(--secondary-color);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
    }
    /* 로봇 스타일 (필수는 아니나 개성을 더함) */
    .robot {
  position: relative;
  width: 160px;
  height: 160px;
  margin: 20px auto;
  background: linear-gradient(to bottom, #f9f9f9, #e0e0e0);
  border: 4px solid #ccc;
  border-radius: 15px;
  box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.1), 0 4px 10px rgba(0, 0, 0, 0.15);
}

/* 기존 눈, 눈동자 등은 그대로 유지 */
.eye {
  position: absolute;
  width: 30px;
  height: 30px;
  background: #fff;
  border: 2px solid #bbb;
  border-radius: 50%;
  overflow: hidden;
  box-shadow: inset 0 0 4px rgba(0, 0, 0, 0.2);
}
.eye.left { top: 40px; left: 30px; }
.eye.right { top: 40px; right: 30px; }
.pupil {
  position: absolute;
  width: 12px;
  height: 12px;
  background: #333;
  border-radius: 50%;
  top: 9px;
  left: 9px;
  transition: transform 0.3s;
}

/* ──────────────────────────────
   레고 팔 스타일
   ────────────────────────────── */
.hand {
  position: absolute;
  width: 16px;            /* 팔 두께 (더 얇게) */
  height: 60px;           /* 팔 길이 (더 길게) */
  background: #90cdf4;    /* 팔 색상 */
  border-radius: 8px;     /* 둥근 모양 */
  top: 30px;              /* 로봇 몸통과 수직 위치 맞춤 */
  transform-origin: top center;
  transition: transform 0.3s;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

/* 팔 상단(어깨) - 위쪽에 원형 디테일 추가 */
.hand::before {
  content: "";
  position: absolute;
  top: -8px;         /* 팔 상단보다 약간 위 */
  left: 50%;
  transform: translateX(-50%);
  width: 20px;       /* 어깨 원 크기 */
  height: 20px;
  background: #90cdf4;
  border-radius: 50%;
  box-shadow: 0 1px 3px rgba(0,0,0,0.2);
}

/* 팔 끝(손목) - 아래쪽에 원형 디테일 추가 */
.hand::after {
  content: "";
  position: absolute;
  bottom: -10px;    /* 팔 끝보다 약간 아래 */
  left: 50%;
  transform: translateX(-50%);
  width: 24px;      /* 손목 원 크기 */
  height: 24px;
  background: #90cdf4;
  border-radius: 50%;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

/* 왼팔 / 오른팔 위치 */
.hand.left {
  left: -12px;       /* 몸통 왼쪽 밖으로 나오게 */
  transform: rotate(-15deg);
}
.hand.right {
  right: -12px;      /* 몸통 오른쪽 밖으로 나오게 */
  transform: rotate(15deg);
}

/* 로봇이 눈을 가릴 때 팔이 몸통 앞으로 오도록 위치 조정 */
.robot.cover .hand.left {
  transform: rotate(-60deg);
}
.robot.cover .hand.right {
  transform: rotate(60deg);
}

/* 눈 깜빡임 애니메이션 그대로 유지 */
.eye::after {
  content: '';
  position: absolute;
  width: 100%;
  height: 100%;
  background: #fff;
  top: 0;
  left: 0;
  border-radius: 50%;
  animation: blink 4s infinite;
  opacity: 0;
}
@keyframes blink {
  0%, 95%, 100% { opacity: 0; }
  96%, 97% { opacity: 1; }
}

  </style>
</head>
<body>
  <!-- SVG clipPath 정의: 퍼즐 조각 모양 -->
  <svg width="0" height="0" style="position:absolute;">
    <defs>
      <clipPath id="puzzleClip" clipPathUnits="objectBoundingBox">
        <path d="
          M0,0
          L0.4,0
          C0.4,0.2 0.6,0.2 0.6,0
          L1,0
          L1,0.4
          C0.8,0.4 0.8,0.6 1,0.6
          L1,1
          L0.6,1
          C0.6,0.8 0.4,0.8 0.4,1
          L0,1
          L0,0.6
          C0.2,0.6 0.2,0.4 0,0.4
          L0,0
          Z
        "/>
      </clipPath>
    </defs>
  </svg>
  
  
  
  <div class="container">
    <!-- 왼쪽 패널: 서비스 소개 및 인트로 메시지 -->
    <div class="left-panel">
      <div class="info-box">
        <h2>GoHigher 서비스 소개</h2>
        <ol>
          <li>직접 분석하여 성장형 종목 추천</li>
          <li>간편한 자산 관리 시스템</li>
          <li>경제지표 분석을 통한 시장 흐름 포착</li>
          <li>섹터별 유망 종목 안내</li>
          <li>이벤트 및 뉴스 실시간 분석</li>
          <li>유명인의 포트폴리오 관람</li>
          <li>매주 경제 일정 안내</li>
        </ol>
      </div>
      <div class="intro-message">
        <div class="wave-text">
          <span style="--i:1">G</span>
          <span style="--i:2">o</span>
          <span style="--i:3">H</span>
          <span style="--i:4">i</span>
          <span style="--i:5">g</span>
          <span style="--i:6">h</span>
          <span style="--i:7">e</span>
          <span style="--i:8">r</span>
        </div>
        <div class="bottom-text">성공 투자로 가는 첫걸음, GoHigher와 함께하세요!</div>
      </div>
    </div>
    <!-- 오른쪽 패널: 로봇, 로그인 및 회원가입 폼 -->
    <div class="right-panel">
      <h1>로그인</h1>
      <div class="robot" id="robot">
        <div class="eye left"><div class="pupil" id="pupil-left"></div></div>
        <div class="eye right"><div class="pupil" id="pupil-right"></div></div>
        <div class="hand left"></div>
        <div class="hand right"></div>
      </div>
      <div class="tab-buttons">
        <button id="loginTab" class="tab active">로그인</button>
        <button id="signupTab" class="tab">회원가입</button>
      </div>
      <div class="tab-content">
        <div id="loginFormContainer" class="tab-panel">
          <h2>이메일로 로그인하기</h2>
          <form id="loginForm">
            <input type="email" id="loginEmail" placeholder="이메일을 입력하세요" required>
            <input type="password" id="loginPassword" placeholder="비밀번호를 입력하세요" required minlength="6">
            <button type="submit">로그인</button>
          </form>
        </div>
        <div id="signupFormContainer" class="tab-panel hidden">
          <h2>이메일로 가입하기</h2>
          <form id="emailVerifyForm">
            <input type="email" id="signupEmail" placeholder="이메일을 입력하세요" required>
            <button type="button" id="sendVerifyEmail">이메일 인증 메일 보내기</button>
          </form>
          <form id="signupForm" class="hidden">
            <input type="password" id="signupPassword" placeholder="비밀번호를 입력하세요" required minlength="6">
            <button type="submit">회원가입</button>
          </form>
        </div>
      </div>
      <div class="divider">또는 다음으로 로그인</div>
      <div class="login-container">
        <button id="googleLogin" class="google-btn">
          <img src="googleLogin.png" alt="Google Logo">
          Google 로그인
        </button>
      </div>
    </div>
  </div>

  <!-- 스크립트: Firebase 초기화 및 탭/로봇 애니메이션 -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
    import {
      getAuth,
      sendEmailVerification,
      createUserWithEmailAndPassword,
      signInWithEmailAndPassword,
      signInWithPopup,
      GoogleAuthProvider,
      updatePassword
    } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-auth.js";
    import {
      getFirestore,
      setDoc,
      doc,
      getDoc
    } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCgFLtAo8LETpHq44hxlT7QigCbIltk-Zk",
      authDomain: "gohigher-55e51.firebaseapp.com",
      projectId: "gohigher-55e51",
      storageBucket: "gohigher-55e51.firebasestorage.app",
      messagingSenderId: "487435343721",
      appId: "1:487435343721:web:dc5708c3a263214fba4ff8",
      measurementId: "G-KQ02L8DXG0"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const provider = new GoogleAuthProvider();

    document.getElementById("googleLogin").addEventListener('click', () => {
      signInWithPopup(auth, provider)
        .then((result) => {
          const user = result.user;
          if (result.additionalUserInfo?.isNewUser) {
            localStorage.setItem("signupMessage", "회원 가입을 축하합니다!");
          }
          localStorage.setItem("isLoggedIn", "true");
          localStorage.setItem("userEmail", user.email);
          localStorage.setItem("userPhoto", user.photoURL);
          localStorage.setItem("userName", user.displayName);
          window.location.href = "index.html";
        })
        .catch((error) => {
          console.error("로그인 실패:", error.message);
          alert("Google 로그인 실패: " + error.message);
        });
    });

    document.getElementById("sendVerifyEmail").addEventListener("click", async () => {
      const email = document.getElementById("signupEmail").value.trim();
      if (!email) {
        alert("이메일을 입력해 주세요.");
        return;
      }
      try {
        const userCredential = await createUserWithEmailAndPassword(auth, email, "TempPassword@123");
        const user = userCredential.user;
        await sendEmailVerification(user);
        alert("이메일 인증 메일을 보냈습니다. 메일함을 확인 후 인증해 주세요.");
        document.getElementById("signupForm").classList.remove("hidden");
      } catch (error) {
        console.error("이메일 인증 요청 실패:", error.code, error.message);
        alert("실패: " + error.message);
      }
    });

    document.getElementById("signupForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const email = document.getElementById("signupEmail").value.trim();
      const password = document.getElementById("signupPassword").value;
      try {
        const userCredential = await signInWithEmailAndPassword(auth, email, "TempPassword@123");
        const user = userCredential.user;
        if (!user.emailVerified) {
          alert("이메일 인증이 완료되지 않았습니다. 메일함을 확인해 주세요.");
          return;
        }
        await updatePassword(user, password);
        await setDoc(doc(db, "users", user.uid), {
          email: user.email,
          createdAt: new Date()
        });
        alert("회원가입이 완료되었습니다! 이제 로그인해 주세요.");
        document.getElementById("signupFormContainer").classList.add("hidden");
        document.getElementById("loginFormContainer").classList.remove("hidden");
      } catch (error) {
        console.error("회원가입 실패:", error.message);
        alert("실패: " + error.message);
      }
    });

    document.getElementById("loginForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const email = document.getElementById("loginEmail").value.trim();
      const password = document.getElementById("loginPassword").value;
      try {
        const userCredential = await signInWithEmailAndPassword(auth, email, password);
        const user = userCredential.user;
        if (!user.emailVerified) {
          alert("이메일 인증이 완료되지 않았습니다.");
          return;
        }
        const userDoc = await getDoc(doc(db, "users", user.uid));
        if (userDoc.exists()) {
          console.log("Firestore 유저 정보:", userDoc.data());
        }
        localStorage.setItem("isLoggedIn", "true");
        localStorage.setItem("userEmail", user.email);
        alert("로그인 성공!");
        window.location.href = "index.html";
      } catch (error) {
        console.error("로그인 실패:", error.message);
        alert("로그인 실패: " + error.message);
      }
    });

    const loginTab = document.getElementById("loginTab");
    const signupTab = document.getElementById("signupTab");
    const loginFormContainer = document.getElementById("loginFormContainer");
    const signupFormContainer = document.getElementById("signupFormContainer");

    loginTab.addEventListener("click", () => {
      loginTab.classList.add("active");
      signupTab.classList.remove("active");
      loginFormContainer.classList.remove("hidden");
      signupFormContainer.classList.add("hidden");
    });

    signupTab.addEventListener("click", () => {
      signupTab.classList.add("active");
      loginTab.classList.remove("active");
      signupFormContainer.classList.remove("hidden");
      loginFormContainer.classList.add("hidden");
    });

    const pupilLeft = document.getElementById('pupil-left');
    const pupilRight = document.getElementById('pupil-right');
    const robot = document.getElementById('robot');
    const emailInputs = [
      document.getElementById('loginEmail'),
      document.getElementById('signupEmail')
    ];
    const passwordInputs = [
      document.getElementById('loginPassword'),
      document.getElementById('signupPassword')
    ];

    function moveEyes(event) {
      const length = event.target.value.length;
      const maxOffsetX = 6;
      const maxOffsetY = 3;
      const offsetX = Math.min(length * 1.5, maxOffsetX);
      const offsetY = Math.min(length * 0.5, maxOffsetY);
      pupilLeft.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
      pupilRight.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
    }
    function coverEyes() {
      robot.classList.add('cover');
    }
    function uncoverEyes() {
      robot.classList.remove('cover');
    }
    emailInputs.forEach(input => input.addEventListener('input', moveEyes));
    passwordInputs.forEach(input => {
      input.addEventListener('focus', coverEyes);
      input.addEventListener('blur', uncoverEyes);
    });
  </script>
</body>
</html>
